(function(b,A){typeof exports=="object"&&typeof module!="undefined"?A(exports,require("vue"),require("vue-demi")):typeof define=="function"&&define.amd?define(["exports","vue","vue-demi"],A):(b=typeof globalThis!="undefined"?globalThis:b||self,A(b["@nhost/vue"]={},b.Vue,b["vue-demi"]))})(this,function(b,A,ft){"use strict";class Je extends Error{}Je.prototype.name="InvalidTokenError";function Ni(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function _i(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Ni(e)}catch{return atob(e)}}function Qt(t,e){if(typeof t!="string")throw new Je("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Je(`Invalid token specified: missing part #${r+1}`);let i;try{i=_i(n)}catch(s){throw new Je(`Invalid token specified: invalid base64 for part #${r+1} (${s.message})`)}try{return JSON.parse(i)}catch(s){throw new Je(`Invalid token specified: invalid json for part #${r+1} (${s.message})`)}}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var T=function(){return T=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},T.apply(this,arguments)};function Xt(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function M(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function j(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(l){o={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function z(t,e,r){if(arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var q;(function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"})(q||(q={}));var Ae;(function(t){t.Parent="#_parent",t.Internal="#_internal"})(Ae||(Ae={}));var pt=q.Start,vt=q.Stop,Le=q.Raise,We=q.Send,Zt=q.Cancel,Hr=q.NullEvent,mt=q.Assign,Ri=q.After,Di=q.DoneState,gt=q.Log,Kr=q.Init,yt=q.Invoke,Pi=q.ErrorExecution,er=q.ErrorPlatform,tr=q.ErrorCustom,Et=q.Update,Yr=q.Choose,zr=q.Pure;const Ci=Object.freeze(Object.defineProperty({__proto__:null,after:Ri,assign:mt,cancel:Zt,choose:Yr,doneState:Di,error:tr,errorExecution:Pi,errorPlatform:er,init:Kr,invoke:yt,log:gt,nullEvent:Hr,pure:zr,raise:Le,send:We,start:pt,stop:vt,update:Et},Symbol.toStringTag,{value:"Module"}));var Jr=".",Wr={},rr="xstate.guard",Ui="",Q=process.env.NODE_ENV==="production",Tt;function nr(t,e,r){r===void 0&&(r=Jr);var n=Qe(t,r),i=Qe(e,r);return V(i)?V(n)?i===n:!1:V(n)?n in i:Object.keys(n).every(function(s){return s in i?nr(n[s],i[s]):!1})}function Qr(t){try{return V(t)||typeof t=="number"?"".concat(t):t.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function ir(t,e){try{return Me(t)?t:t.toString().split(e)}catch{throw new Error("'".concat(t,"' is not a valid state path."))}}function Li(t){return typeof t=="object"&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function Qe(t,e){if(Li(t))return t.value;if(Me(t))return St(t);if(typeof t!="string")return t;var r=ir(t,e);return St(r)}function St(t){if(t.length===1)return t[0];for(var e={},r=e,n=0;n<t.length-1;n++)n===t.length-2?r[t[n]]=t[n+1]:(r[t[n]]={},r=r[t[n]]);return e}function Xe(t,e){for(var r={},n=Object.keys(t),i=0;i<n.length;i++){var s=n[i];r[s]=e(t[s],s,t,i)}return r}function Xr(t,e,r){var n,i,s={};try{for(var o=M(Object.keys(t)),l=o.next();!l.done;l=o.next()){var d=l.value,u=t[d];r(u)&&(s[d]=e(u,d,t))}}catch(a){n={error:a}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}var Mi=function(t){return function(e){var r,n,i=e;try{for(var s=M(t),o=s.next();!o.done;o=s.next()){var l=o.value;i=i[l]}}catch(d){r={error:d}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}};function Fi(t,e){return function(r){var n,i,s=r;try{for(var o=M(t),l=o.next();!l.done;l=o.next()){var d=l.value;s=s[e][d]}}catch(u){n={error:u}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}}function wt(t){if(!t)return[[]];if(V(t))return[[t]];var e=X(Object.keys(t).map(function(r){var n=t[r];return typeof n!="string"&&(!n||!Object.keys(n).length)?[[r]]:wt(t[r]).map(function(i){return[r].concat(i)})}));return e}function X(t){var e;return(e=[]).concat.apply(e,z([],j(t),!1))}function Zr(t){return Me(t)?t:[t]}function pe(t){return t===void 0?[]:Zr(t)}function kt(t,e,r){var n,i;if($(t))return t(e,r.data);var s={};try{for(var o=M(Object.keys(t)),l=o.next();!l.done;l=o.next()){var d=l.value,u=t[d];$(u)?s[d]=u(e,r.data):s[d]=u}}catch(a){n={error:a}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}function ji(t){return/^(done|error)\./.test(t)}function en(t){return!!(t instanceof Promise||t!==null&&($(t)||typeof t=="object")&&$(t.then))}function $i(t){return t!==null&&typeof t=="object"&&"transition"in t&&typeof t.transition=="function"}function Vi(t,e){var r,n,i=j([[],[]],2),s=i[0],o=i[1];try{for(var l=M(t),d=l.next();!d.done;d=l.next()){var u=d.value;e(u)?s.push(u):o.push(u)}}catch(a){r={error:a}}finally{try{d&&!d.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return[s,o]}function tn(t,e){return Xe(t.states,function(r,n){if(r){var i=(V(e)?void 0:e[n])||(r?r.current:void 0);if(i)return{current:i,states:tn(r,i)}}})}function Bi(t,e){return{current:e,states:tn(t,e)}}function rn(t,e,r,n){Q||ie(!!t,"Attempting to update undefined context");var i=t&&r.reduce(function(s,o){var l,d,u=o.assignment,a={state:n,action:o,_event:e},c={};if($(u))c=u(s,e.data,a);else try{for(var h=M(Object.keys(u)),f=h.next();!f.done;f=h.next()){var p=f.value,m=u[p];c[p]=$(m)?m(s,e.data,a):m}}catch(k){l={error:k}}finally{try{f&&!f.done&&(d=h.return)&&d.call(h)}finally{if(l)throw l.error}}return Object.assign({},s,c)},t);return i}var ie=function(){};Q||(ie=function(t,e){var r=t instanceof Error?t:void 0;if(!(!r&&t)&&console!==void 0){var n=["Warning: ".concat(e)];r&&n.push(r),console.warn.apply(console,n)}});function Me(t){return Array.isArray(t)}function $(t){return typeof t=="function"}function V(t){return typeof t=="string"}function nn(t,e){if(t)return V(t)?{type:rr,name:t,predicate:e?e[t]:void 0}:$(t)?{type:rr,name:t.name,predicate:t}:t}function Gi(t){try{return"subscribe"in t&&$(t.subscribe)}catch{return!1}}var Ie=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();Tt={},Tt[Ie]=function(){return this},Tt[Symbol.observable]=function(){return this};function we(t){return!!t&&"__xstatenode"in t}function qi(t){return!!t&&typeof t.send=="function"}var Hi=function(){var t=0;return function(){return t++,t.toString(16)}}();function xt(t,e){return V(t)||typeof t=="number"?T({type:t},e):t}function ae(t,e){if(!V(t)&&"$$type"in t&&t.$$type==="scxml")return t;var r=xt(t);return T({name:r.type,data:r,$$type:"scxml",type:"external"},e)}function Fe(t,e){var r=Zr(e).map(function(n){return typeof n=="undefined"||typeof n=="string"||we(n)?{target:n,event:t}:T(T({},n),{event:t})});return r}function Ki(t){if(!(t===void 0||t===Ui))return pe(t)}function Yi(t,e,r){if(!Q){var n=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";if(t===e)console.error("Missing onError handler for invocation '".concat(r,"', error was '").concat(t,"'.").concat(n));else{var i=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(r,"'. ")+"Original error: '".concat(t,"'. ").concat(n," Current error is '").concat(e,"'.").concat(i))}}}function sn(t,e,r,n,i){var s=t.options.guards,o={state:i,cond:e,_event:n};if(e.type===rr)return((s==null?void 0:s[e.name])||e.predicate)(r,n.data,o);var l=s==null?void 0:s[e.type];if(!l)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return l(r,n.data,o)}function on(t){return typeof t=="string"?{type:t}:t}function Ze(t,e,r){var n=function(){},i=typeof t=="object",s=i?t:null;return{next:((i?t.next:t)||n).bind(s),error:((i?t.error:e)||n).bind(s),complete:((i?t.complete:r)||n).bind(s)}}function At(t,e){return"".concat(t,":invocation[").concat(e,"]")}function sr(t){return(t.type===Le||t.type===We&&t.to===Ae.Internal)&&typeof t.delay!="number"}var be=ae({type:Kr});function It(t,e){return e&&e[t]||void 0}function je(t,e){var r;if(V(t)||typeof t=="number"){var n=It(t,e);$(n)?r={type:t,exec:n}:n?r=n:r={type:t,exec:void 0}}else if($(t))r={type:t.name||t.toString(),exec:t};else{var n=It(t.type,e);if($(n))r=T(T({},t),{exec:n});else if(n){var i=n.type||t.type;r=T(T(T({},n),t),{type:i})}else r=t}return r}var ke=function(t,e){if(!t)return[];var r=Me(t)?t:[t];return r.map(function(n){return je(n,e)})};function Ot(t){var e=je(t);return T(T({id:V(t)?t:e.id},e),{type:e.type})}function an(t,e){return{type:Le,event:typeof t=="function"?t:xt(t),delay:e?e.delay:void 0,id:e==null?void 0:e.id}}function cn(t,e,r,n){var i={_event:r},s=ae($(t.event)?t.event(e,r.data,i):t.event),o;if(V(t.delay)){var l=n&&n[t.delay];o=$(l)?l(e,r.data,i):l}else o=$(t.delay)?t.delay(e,r.data,i):t.delay;return T(T({},t),{type:Le,_event:s,delay:o})}function Ne(t,e){return{to:e?e.to:void 0,type:We,event:$(t)?t:xt(t),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:$(t)?t.name:Qr(t)}}function un(t,e,r,n){var i={_event:r},s=ae($(t.event)?t.event(e,r.data,i):t.event),o;if(V(t.delay)){var l=n&&n[t.delay];o=$(l)?l(e,r.data,i):l}else o=$(t.delay)?t.delay(e,r.data,i):t.delay;var d=$(t.to)?t.to(e,r.data,i):t.to;return T(T({},t),{to:d,_event:s,event:s.data,delay:o})}function or(t,e){return Ne(t,T(T({},e),{to:Ae.Parent}))}function zi(t,e,r){return Ne(e,T(T({},r),{to:t}))}function Ji(){return or(Et)}function Wi(t,e){return Ne(t,T(T({},e),{to:function(r,n,i){var s=i._event;return s.origin}}))}var Qi=function(t,e){return{context:t,event:e}};function Xi(t,e){return t===void 0&&(t=Qi),{type:gt,label:e,expr:t}}var ln=function(t,e,r){return T(T({},t),{value:V(t.expr)?t.expr:t.expr(e,r.data,{_event:r})})},dn=function(t){return{type:Zt,sendId:t}};function hn(t){var e=Ot(t);return{type:q.Start,activity:e,exec:void 0}}function fn(t){var e=$(t)?t:Ot(t);return{type:q.Stop,activity:e,exec:void 0}}function pn(t,e,r){var n=$(t.activity)?t.activity(e,r.data):t.activity,i=typeof n=="string"?{id:n}:n,s={type:q.Stop,activity:i};return s}var vn=function(t){return{type:mt,assignment:t}};function Zi(t){return typeof t=="object"&&"type"in t}function mn(t,e){var r=e?"#".concat(e):"";return"".concat(q.After,"(").concat(t,")").concat(r)}function et(t,e){var r="".concat(q.DoneState,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function tt(t,e){var r="".concat(q.DoneInvoke,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function $e(t,e){var r="".concat(q.ErrorPlatform,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function es(t){return{type:q.Pure,get:t}}function ts(t,e){if(!Q&&(!t||typeof t=="function")){var r=t;t=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=typeof r=="function"?r.apply(void 0,z([],j(n),!1)):r;if(!s)throw new Error("Attempted to forward event to undefined actor. This risks an infinite loop in the sender.");return s}}return Ne(function(n,i){return i},T(T({},e),{to:t}))}function rs(t,e){return or(function(r,n,i){return{type:tr,data:$(t)?t(r,n,i):t}},T(T({},e),{to:Ae.Parent}))}function ns(t){return{type:q.Choose,conds:t}}var is=function(t){var e,r,n=[];try{for(var i=M(t),s=i.next();!s.done;s=i.next())for(var o=s.value,l=0;l<o.actions.length;){if(o.actions[l].type===mt){n.push(o.actions[l]),o.actions.splice(l,1);continue}l++}}catch(d){e={error:d}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n};function rt(t,e,r,n,i,s,o){o===void 0&&(o=!1);var l=o?[]:is(i),d=l.length?rn(r,n,l,e):r,u=o?[r]:void 0,a=[];function c(p,m){var k;switch(m.type){case Le:{var E=cn(m,d,n,t.options.delays);return s&&typeof E.delay=="number"&&s(E,d,n),E}case We:var w=un(m,d,n,t.options.delays);if(!Q){var x=m.delay;ie(!V(x)||typeof w.delay=="number","No delay reference for delay expression '".concat(x,"' was found on machine '").concat(t.id,"'"))}return s&&w.to!==Ae.Internal&&(p==="entry"?a.push(w):s(w,d,n)),w;case gt:{var O=ln(m,d,n);return s==null||s(O,d,n),O}case Yr:{var F=m,U=(k=F.conds.find(function(v){var S=nn(v.cond,t.options.guards);return!S||sn(t,S,d,n,s?void 0:e)}))===null||k===void 0?void 0:k.actions;if(!U)return[];var P=j(rt(t,e,d,n,[{type:p,actions:ke(pe(U),t.options.actions)}],s,o),2),H=P[0],L=P[1];return d=L,u==null||u.push(d),H}case zr:{var U=m.get(d,n.data);if(!U)return[];var Z=j(rt(t,e,d,n,[{type:p,actions:ke(pe(U),t.options.actions)}],s,o),2),R=Z[0],K=Z[1];return d=K,u==null||u.push(d),R}case vt:{var O=pn(m,d,n);return s==null||s(O,r,n),O}case mt:{d=rn(d,n,[m],s?void 0:e),u==null||u.push(d);break}default:var te=je(m,t.options.actions),W=te.exec;if(s)s(te,d,n);else if(W&&u){var Ce=u.length-1,Ue=T(T({},te),{exec:function(v){for(var S=[],N=1;N<arguments.length;N++)S[N-1]=arguments[N];W.apply(void 0,z([u[Ce]],j(S),!1))}});te=Ue}return te}}function h(p){var m,k,E=[];try{for(var w=M(p.actions),x=w.next();!x.done;x=w.next()){var O=x.value,F=c(p.type,O);F&&(E=E.concat(F))}}catch(U){m={error:U}}finally{try{x&&!x.done&&(k=w.return)&&k.call(w)}finally{if(m)throw m.error}}return a.forEach(function(U){s(U,d,n)}),a.length=0,E}var f=X(i.map(h));return[f,d]}const ss=Object.freeze(Object.defineProperty({__proto__:null,actionTypes:Ci,after:mn,assign:vn,cancel:dn,choose:ns,done:et,doneInvoke:tt,error:$e,escalate:rs,forwardTo:ts,getActionFunction:It,initEvent:be,isActionObject:Zi,log:Xi,pure:es,raise:an,resolveActions:rt,resolveLog:ln,resolveRaise:cn,resolveSend:un,resolveStop:pn,respond:Wi,send:Ne,sendParent:or,sendTo:zi,sendUpdate:Ji,start:hn,stop:fn,toActionObject:je,toActionObjects:ke,toActivityDefinition:Ot},Symbol.toStringTag,{value:"Module"}));var bt=[],Ve=function(t,e){bt.push(t);var r=e(t);return bt.pop(),r},os=function(t){return t(bt[bt.length-1])};function gn(t){var e;return e={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}},e[Ie]=function(){return this},e}function as(t,e,r,n){var i,s=on(t.src),o=(i=e==null?void 0:e.options.services)===null||i===void 0?void 0:i[s.type],l=t.data?kt(t.data,r,n):void 0,d=o?ar(o,t.id,l):gn(t.id);return d.meta=t,d}function ar(t,e,r){var n=gn(e);if(n.deferred=!0,we(t)){var i=n.state=Ve(void 0,function(){return(r?t.withContext(r):t).initialState});n.getSnapshot=function(){return i}}return n}function cs(t){try{return typeof t.send=="function"}catch{return!1}}function us(t){return cs(t)&&"id"in t}function ls(t){var e;return T((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[Ie]=function(){return this},e),t)}var Nt=function(t){return t.type==="atomic"||t.type==="final"};function yn(t){return Object.keys(t.states).map(function(e){return t.states[e]})}function nt(t){return yn(t).filter(function(e){return e.type!=="history"})}function En(t){var e=[t];return Nt(t)?e:e.concat(X(nt(t).map(En)))}function it(t,e){var r,n,i,s,o,l,d,u,a=new Set(t),c=cr(a),h=new Set(e);try{for(var f=M(h),p=f.next();!p.done;p=f.next())for(var m=p.value,k=m.parent;k&&!h.has(k);)h.add(k),k=k.parent}catch(L){r={error:L}}finally{try{p&&!p.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}var E=cr(h);try{for(var w=M(h),x=w.next();!x.done;x=w.next()){var m=x.value;if(m.type==="compound"&&(!E.get(m)||!E.get(m).length))c.get(m)?c.get(m).forEach(function(Z){return h.add(Z)}):m.initialStateNodes.forEach(function(Z){return h.add(Z)});else if(m.type==="parallel")try{for(var O=(o=void 0,M(nt(m))),F=O.next();!F.done;F=O.next()){var U=F.value;h.has(U)||(h.add(U),c.get(U)?c.get(U).forEach(function(Z){return h.add(Z)}):U.initialStateNodes.forEach(function(Z){return h.add(Z)}))}}catch(Z){o={error:Z}}finally{try{F&&!F.done&&(l=O.return)&&l.call(O)}finally{if(o)throw o.error}}}}catch(L){i={error:L}}finally{try{x&&!x.done&&(s=w.return)&&s.call(w)}finally{if(i)throw i.error}}try{for(var P=M(h),H=P.next();!H.done;H=P.next())for(var m=H.value,k=m.parent;k&&!h.has(k);)h.add(k),k=k.parent}catch(L){d={error:L}}finally{try{H&&!H.done&&(u=P.return)&&u.call(P)}finally{if(d)throw d.error}}return h}function Tn(t,e){var r=e.get(t);if(!r)return{};if(t.type==="compound"){var n=r[0];if(n){if(Nt(n))return n.key}else return{}}var i={};return r.forEach(function(s){i[s.key]=Tn(s,e)}),i}function cr(t){var e,r,n=new Map;try{for(var i=M(t),s=i.next();!s.done;s=i.next()){var o=s.value;n.has(o)||n.set(o,[]),o.parent&&(n.has(o.parent)||n.set(o.parent,[]),n.get(o.parent).push(o))}}catch(l){e={error:l}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function ds(t,e){var r=it([t],e);return Tn(t,cr(r))}function st(t,e){return Array.isArray(t)?t.some(function(r){return r===e}):t instanceof Set?t.has(e):!1}function hs(t){return z([],j(new Set(X(z([],j(t.map(function(e){return e.ownEvents})),!1)))),!1)}function _t(t,e){return e.type==="compound"?nt(e).some(function(r){return r.type==="final"&&st(t,r)}):e.type==="parallel"?nt(e).every(function(r){return _t(t,r)}):!1}function fs(t){return t===void 0&&(t=[]),t.reduce(function(e,r){return r.meta!==void 0&&(e[r.id]=r.meta),e},{})}function Sn(t){return new Set(X(t.map(function(e){return e.tags})))}function wn(t,e){if(t===e)return!0;if(t===void 0||e===void 0)return!1;if(V(t)||V(e))return t===e;var r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&r.every(function(i){return wn(t[i],e[i])})}function ps(t){return typeof t!="object"||t===null?!1:"value"in t&&"_event"in t}function vs(t,e){var r=t.exec,n=T(T({},t),{exec:r!==void 0?function(){return r(e.context,e.event,{action:t,state:e,_event:e._event})}:void 0});return n}var ve=function(){function t(e){var r=this,n;this.actions=[],this.activities=Wr,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||Wr,this.meta=fs(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(n=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&n!==void 0?n:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return hs(r.configuration)}})}return t.from=function(e,r){if(e instanceof t)return e.context!==r?new t({value:e.value,context:r,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var n=be;return new t({value:e,context:r,_event:n,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,r){if(e instanceof t){if(!e.actions.length)return e;var n=be;return new t({value:e.value,context:r,_event:n,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,r)},t.prototype.toStrings=function(e,r){var n=this;if(e===void 0&&(e=this.value),r===void 0&&(r="."),V(e))return[e];var i=Object.keys(e);return i.concat.apply(i,z([],j(i.map(function(s){return n.toStrings(e[s],r).map(function(o){return s+r+o})})),!1))},t.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var r=e.tags;e.machine;var n=Xt(e,["configuration","transitions","tags","machine"]);return T(T({},n),{tags:Array.from(r)})},t.prototype.matches=function(e){return nr(e,this.value)},t.prototype.hasTag=function(e){return this.tags.has(e)},t.prototype.can=function(e){var r;Q&&ie(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var n=(r=this.machine)===null||r===void 0?void 0:r.getTransitionData(this,e);return!!(n!=null&&n.transitions.length)&&n.transitions.some(function(i){return i.target!==void 0||i.actions.length})},t}(),ms={deferEvents:!1},kn=function(){function t(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=T(T({},ms),e)}return t.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},t.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},t.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(r){throw this.clear(),r}finally{this.processingEvent=!1}},t}(),ur=new Map,gs=0,ot={bookId:function(){return"x:".concat(gs++)},register:function(t,e){return ur.set(t,e),t},get:function(t){return ur.get(t)},free:function(t){ur.delete(t)}};function lr(){if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;Q||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues")}function ys(){var t=lr();if(t&&"__xstate__"in t)return t.__xstate__}function Es(t){if(lr()){var e=ys();e&&e.register(t)}}function Ts(t,e){e===void 0&&(e={});var r=t.initialState,n=new Set,i=[],s=!1,o=function(){if(!s){for(s=!0;i.length>0;){var u=i.shift();r=t.transition(r,u,d),n.forEach(function(a){return a.next(r)})}s=!1}},l=ls({id:e.id,send:function(u){i.push(u),o()},getSnapshot:function(){return r},subscribe:function(u,a,c){var h=Ze(u,a,c);return n.add(h),h.next(r),{unsubscribe:function(){n.delete(h)}}}}),d={parent:e.parent,self:l,id:e.id||"anonymous",observers:n};return r=t.start?t.start(d):r,l}var dr={sync:!1,autoForward:!1},re;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(re||(re={}));var Ss=function(){function t(e,r){r===void 0&&(r=t.defaultOptions);var n=this;this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=re.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(a,c){if(Me(a))return n.batch(a),n.state;var h=ae(xt(a,c));if(n.status===re.Stopped)return Q||ie(!1,'Event "'.concat(h.name,'" was sent to stopped service "').concat(n.machine.id,`". This service has already reached its final state, and will not transition.
Event: `).concat(JSON.stringify(h.data))),n.state;if(n.status!==re.Running&&!n.options.deferEvents)throw new Error('Event "'.concat(h.name,'" was sent to uninitialized service "').concat(n.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(h.data)));return n.scheduler.schedule(function(){n.forward(h);var f=n._nextState(h);n.update(f,h)}),n._state},this.sendTo=function(a,c,h){var f=n.parent&&(c===Ae.Parent||n.parent.id===c),p=f?n.parent:V(c)?c===Ae.Internal?n:n.children.get(c)||ot.get(c):qi(c)?c:void 0;if(!p){if(!f)throw new Error("Unable to send event to child '".concat(c,"' from service '").concat(n.id,"'."));Q||ie(!1,"Service '".concat(n.id,"' has no parent: unable to send event ").concat(a.type));return}if("machine"in p){if(n.status!==re.Stopped||n.parent!==p||n.state.done){var m=T(T({},a),{name:a.name===tr?"".concat($e(n.id)):a.name,origin:n.sessionId});!h&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([p,m]):p.send(m)}}else!h&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([p,a.data]):p.send(a.data)},this._exec=function(a,c,h,f){f===void 0&&(f=n.machine.options.actions);var p=a.exec||It(a.type,f),m=$(p)?p:p?p.exec:a.exec;if(m)try{return m(c,h.data,n.machine.config.predictableActionArguments?{action:a,_event:h}:{action:a,state:n.state,_event:h})}catch(W){throw n.parent&&n.parent.send({type:"xstate.error",data:W}),W}switch(a.type){case Le:{var k=a;n.defer(k);break}case We:var E=a;if(typeof E.delay=="number"){n.defer(E);return}else E.to?n.sendTo(E._event,E.to,h===be):n.send(E._event);break;case Zt:n.cancel(a.sendId);break;case pt:{if(n.status!==re.Running)return;var w=a.activity;if(!n.machine.config.predictableActionArguments&&!n.state.activities[w.id||w.type])break;if(w.type===q.Invoke){var x=on(w.src),O=n.machine.options.services?n.machine.options.services[x.type]:void 0,F=w.id,U=w.data;Q||ie(!("forward"in w),"`forward` property is deprecated (found in invocation of '".concat(w.src,"' in in machine '").concat(n.machine.id,"'). ")+"Please use `autoForward` instead.");var P="autoForward"in w?w.autoForward:!!w.forward;if(!O){Q||ie(!1,"No service found for invocation '".concat(w.src,"' in machine '").concat(n.machine.id,"'."));return}var H=U?kt(U,c,h):void 0;if(typeof O=="string")return;var L=$(O)?O(c,h.data,{data:H,src:x,meta:w.meta}):O;if(!L)return;var Z=void 0;we(L)&&(L=H?L.withContext(H):L,Z={autoForward:P}),n.spawn(L,F,Z)}else n.spawnActivity(w);break}case vt:{n.stopChild(a.activity.id);break}case gt:var R=a,K=R.label,te=R.value;K?n.logger(K,te):n.logger(te);break;default:Q||ie(!1,"No implementation found for action type '".concat(a.type,"'"));break}};var i=T(T({},t.defaultOptions),r),s=i.clock,o=i.logger,l=i.parent,d=i.id,u=d!==void 0?d:e.id;this.id=u,this.logger=o,this.clock=s,this.parent=l,this.options=i,this.scheduler=new kn({deferEvents:this.options.deferEvents}),this.sessionId=ot.bookId()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:Ve(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return Q||ie(this.status!==re.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(e,r){var n,i;try{for(var s=M(e.actions),o=s.next();!o.done;o=s.next()){var l=o.value;this.exec(l,e,r)}}catch(d){n={error:d}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}},t.prototype.update=function(e,r){var n,i,s,o,l,d,u,a,c=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||r===be)&&this.options.execute)this.execute(this.state);else for(var h=void 0;h=this._outgoingQueue.shift();)h[0].send(h[1]);if(this.children.forEach(function(L){c.state.children[L.id]=L}),this.devTools&&this.devTools.send(r.data,e),e.event)try{for(var f=M(this.eventListeners),p=f.next();!p.done;p=f.next()){var m=p.value;m(e.event)}}catch(L){n={error:L}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}try{for(var k=M(this.listeners),E=k.next();!E.done;E=k.next()){var m=E.value;m(e,e.event)}}catch(L){s={error:L}}finally{try{E&&!E.done&&(o=k.return)&&o.call(k)}finally{if(s)throw s.error}}try{for(var w=M(this.contextListeners),x=w.next();!x.done;x=w.next()){var O=x.value;O(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(L){l={error:L}}finally{try{x&&!x.done&&(d=w.return)&&d.call(w)}finally{if(l)throw l.error}}if(this.state.done){var F=e.configuration.find(function(L){return L.type==="final"&&L.parent===c.machine}),U=F&&F.doneData?kt(F.doneData,e.context,r):void 0;this._doneEvent=tt(this.id,U);try{for(var P=M(this.doneListeners),H=P.next();!H.done;H=P.next()){var m=H.value;m(this._doneEvent)}}catch(L){u={error:L}}finally{try{H&&!H.done&&(a=P.return)&&a.call(P)}finally{if(u)throw u.error}}this._stop(),this._stopChildren(),ot.free(this.sessionId)}},t.prototype.onTransition=function(e){return this.listeners.add(e),this.status===re.Running&&e(this.state,this.state.event),this},t.prototype.subscribe=function(e,r,n){var i=this,s=Ze(e,r,n);this.listeners.add(s.next),this.status!==re.NotStarted&&s.next(this.state);var o=function(){i.doneListeners.delete(o),i.stopListeners.delete(o),s.complete()};return this.status===re.Stopped?s.complete():(this.onDone(o),this.onStop(o)),{unsubscribe:function(){i.listeners.delete(s.next),i.doneListeners.delete(o),i.stopListeners.delete(o)}}},t.prototype.onEvent=function(e){return this.eventListeners.add(e),this},t.prototype.onSend=function(e){return this.sendListeners.add(e),this},t.prototype.onChange=function(e){return this.contextListeners.add(e),this},t.prototype.onStop=function(e){return this.stopListeners.add(e),this},t.prototype.onDone=function(e){return this.status===re.Stopped&&this._doneEvent?e(this._doneEvent):this.doneListeners.add(e),this},t.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},t.prototype.start=function(e){var r=this;if(this.status===re.Running)return this;this.machine._init(),ot.register(this.sessionId,this),this.initialized=!0,this.status=re.Running;var n=e===void 0?this.initialState:Ve(this,function(){return ps(e)?r.machine.resolveState(e):r.machine.resolveState(ve.from(e,r.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){r.update(n,be)}),this},t.prototype._stopChildren=function(){this.children.forEach(function(e){$(e.stop)&&e.stop()}),this.children.clear()},t.prototype._stop=function(){var e,r,n,i,s,o,l,d,u,a;try{for(var c=M(this.listeners),h=c.next();!h.done;h=c.next()){var f=h.value;this.listeners.delete(f)}}catch(P){e={error:P}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}try{for(var p=M(this.stopListeners),m=p.next();!m.done;m=p.next()){var f=m.value;f(),this.stopListeners.delete(f)}}catch(P){n={error:P}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}try{for(var k=M(this.contextListeners),E=k.next();!E.done;E=k.next()){var f=E.value;this.contextListeners.delete(f)}}catch(P){s={error:P}}finally{try{E&&!E.done&&(o=k.return)&&o.call(k)}finally{if(s)throw s.error}}try{for(var w=M(this.doneListeners),x=w.next();!x.done;x=w.next()){var f=x.value;this.doneListeners.delete(f)}}catch(P){l={error:P}}finally{try{x&&!x.done&&(d=w.return)&&d.call(w)}finally{if(l)throw l.error}}if(!this.initialized)return this;this.initialized=!1,this.status=re.Stopped,this._initialState=void 0;try{for(var O=M(Object.keys(this.delayedEventsMap)),F=O.next();!F.done;F=O.next()){var U=F.value;this.clock.clearTimeout(this.delayedEventsMap[U])}}catch(P){u={error:P}}finally{try{F&&!F.done&&(a=O.return)&&a.call(O)}finally{if(u)throw u.error}}this.scheduler.clear(),this.scheduler=new kn({deferEvents:this.options.deferEvents})},t.prototype.stop=function(){var e=this,r=this.scheduler;return this._stop(),r.schedule(function(){var n;if(!(!((n=e._state)===null||n===void 0)&&n.done)){var i=ae({type:"xstate.stop"}),s=Ve(e,function(){var o=X(z([],j(e.state.configuration),!1).sort(function(c,h){return h.order-c.order}).map(function(c){return ke(c.onExit,e.machine.options.actions)})),l=j(rt(e.machine,e.state,e.state.context,i,[{type:"exit",actions:o}],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),d=l[0],u=l[1],a=new ve({value:e.state.value,context:u,_event:i,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:d.filter(function(c){return!sr(c)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return a.changed=!0,a});e.update(s,i),e._stopChildren(),ot.free(e.sessionId)}}),this},t.prototype.batch=function(e){var r=this;if(this.status===re.NotStarted&&this.options.deferEvents)Q||ie(!1,"".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,`" and are deferred. Make sure .start() is called for this service.
Event: `).concat(JSON.stringify(event)));else if(this.status!==re.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(e.length){var n=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var i,s,o=r.state,l=!1,d=[],u=function(f){var p=ae(f);r.forward(p),o=Ve(r,function(){return r.machine.transition(o,p,void 0,n||void 0)}),d.push.apply(d,z([],j(r.machine.config.predictableActionArguments?o.actions:o.actions.map(function(m){return vs(m,o)})),!1)),l=l||!!o.changed};try{for(var a=M(e),c=a.next();!c.done;c=a.next()){var h=c.value;u(h)}}catch(f){i={error:f}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}o.changed=l,o.actions=d,r.update(o,ae(e[e.length-1]))})}},t.prototype.sender=function(e){return this.send.bind(this,e)},t.prototype._nextState=function(e,r){var n=this;r===void 0&&(r=!!this.machine.config.predictableActionArguments&&this._exec);var i=ae(e);if(i.name.indexOf(er)===0&&!this.state.nextEvents.some(function(o){return o.indexOf(er)===0}))throw i.data.data;var s=Ve(this,function(){return n.machine.transition(n.state,i,void 0,r||void 0)});return s},t.prototype.nextState=function(e){return this._nextState(e,!1)},t.prototype.forward=function(e){var r,n;try{for(var i=M(this.forwardTo),s=i.next();!s.done;s=i.next()){var o=s.value,l=this.children.get(o);if(!l)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));l.send(e)}}catch(d){r={error:d}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.defer=function(e){var r=this,n=this.clock.setTimeout(function(){"to"in e&&e.to?r.sendTo(e._event,e.to,!0):r.send(e._event)},e.delay);e.id&&(this.delayedEventsMap[e.id]=n)},t.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},t.prototype.exec=function(e,r,n){n===void 0&&(n=this.machine.options.actions),this._exec(e,r.context,r._event,n)},t.prototype.removeChild=function(e){var r;this.children.delete(e),this.forwardTo.delete(e),(r=this.state)===null||r===void 0||delete r.children[e]},t.prototype.stopChild=function(e){var r=this.children.get(e);r&&(this.removeChild(e),$(r.stop)&&r.stop())},t.prototype.spawn=function(e,r,n){if(this.status!==re.Running)return ar(e,r);if(en(e))return this.spawnPromise(Promise.resolve(e),r);if($(e))return this.spawnCallback(e,r);if(us(e))return this.spawnActor(e,r);if(Gi(e))return this.spawnObservable(e,r);if(we(e))return this.spawnMachine(e,T(T({},n),{id:r}));if($i(e))return this.spawnBehavior(e,r);throw new Error('Unable to spawn entity "'.concat(r,'" of type "').concat(typeof e,'".'))},t.prototype.spawnMachine=function(e,r){var n=this;r===void 0&&(r={});var i=new t(e,T(T({},this.options),{parent:this,id:r.id||e.id})),s=T(T({},dr),r);s.sync&&i.onTransition(function(l){n.send(Et,{state:l,id:i.id})});var o=i;return this.children.set(i.id,o),s.autoForward&&this.forwardTo.add(i.id),i.onDone(function(l){n.removeChild(i.id),n.send(ae(l,{origin:i.id}))}).start(),o},t.prototype.spawnBehavior=function(e,r){var n=Ts(e,{id:r,parent:this});return this.children.set(r,n),n},t.prototype.spawnPromise=function(e,r){var n,i=this,s=!1,o;e.then(function(d){s||(o=d,i.removeChild(r),i.send(ae(tt(r,d),{origin:r})))},function(d){if(!s){i.removeChild(r);var u=$e(r,d);try{i.send(ae(u,{origin:r}))}catch(a){Yi(d,a,r),i.devTools&&i.devTools.send(u,i.state),i.machine.strict&&i.stop()}}});var l=(n={id:r,send:function(){},subscribe:function(d,u,a){var c=Ze(d,u,a),h=!1;return e.then(function(f){h||(c.next(f),!h&&c.complete())},function(f){h||c.error(f)}),{unsubscribe:function(){return h=!0}}},stop:function(){s=!0},toJSON:function(){return{id:r}},getSnapshot:function(){return o}},n[Ie]=function(){return this},n);return this.children.set(r,l),l},t.prototype.spawnCallback=function(e,r){var n,i=this,s=!1,o=new Set,l=new Set,d,u=function(h){d=h,l.forEach(function(f){return f(h)}),!s&&i.send(ae(h,{origin:r}))},a;try{a=e(u,function(h){o.add(h)})}catch(h){this.send($e(r,h))}if(en(a))return this.spawnPromise(a,r);var c=(n={id:r,send:function(h){return o.forEach(function(f){return f(h)})},subscribe:function(h){var f=Ze(h);return l.add(f.next),{unsubscribe:function(){l.delete(f.next)}}},stop:function(){s=!0,$(a)&&a()},toJSON:function(){return{id:r}},getSnapshot:function(){return d}},n[Ie]=function(){return this},n);return this.children.set(r,c),c},t.prototype.spawnObservable=function(e,r){var n,i=this,s,o=e.subscribe(function(d){s=d,i.send(ae(d,{origin:r}))},function(d){i.removeChild(r),i.send(ae($e(r,d),{origin:r}))},function(){i.removeChild(r),i.send(ae(tt(r),{origin:r}))}),l=(n={id:r,send:function(){},subscribe:function(d,u,a){return e.subscribe(d,u,a)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return s},toJSON:function(){return{id:r}}},n[Ie]=function(){return this},n);return this.children.set(r,l),l},t.prototype.spawnActor=function(e,r){return this.children.set(r,e),e},t.prototype.spawnActivity=function(e){var r=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(!r){Q||ie(!1,"No implementation found for activity '".concat(e.type,"'"));return}var n=r(this.state.context,e);this.spawnEffect(e.id,n)},t.prototype.spawnEffect=function(e,r){var n;this.children.set(e,(n={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:r||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}},n[Ie]=function(){return this},n))},t.prototype.attachDev=function(){var e=lr();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var r=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(T(T({name:this.id,autoPause:!0,stateSanitizer:function(n){return{value:n.value,context:n.context,actions:n.actions}}},r),{features:T({jump:!1,skip:!1},r?r.features:void 0)}),this.machine),this.devTools.init(this.state)}Es(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[Ie]=function(){return this},t.prototype.getSnapshot=function(){return this.status===re.NotStarted?this.initialState:this._state},t.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,r){return setTimeout(e,r)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},t.interpret=_e,t}(),ws=function(t){return V(t)?T(T({},dr),{name:t}):T(T(T({},dr),{name:Hi()}),t)};function ks(t,e){var r=ws(e);return os(function(n){if(!Q){var i=we(t)||$(t);ie(!!n||i,'Attempted to spawn an Actor (ID: "'.concat(we(t)?t.id:"undefined",'") outside of a service. This will have no effect.'))}return n?n.spawn(t,r.name,r):ar(t,r.name)})}function _e(t,e){var r=new Ss(t,e);return r}function xs(t){if(typeof t=="string"){var e={type:t};return e.toString=function(){return t},e}return t}function Rt(t){return T(T({type:yt},t),{toJSON:function(){t.onDone,t.onError;var e=Xt(t,["onDone","onError"]);return T(T({},e),{type:yt,src:xs(t.src)})}})}var Be="",hr="#",at="*",Ge={},qe=function(t){return t[0]===hr},As=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},Is=function(t,e,r){var n=r.slice(0,-1).some(function(s){return!("cond"in s)&&!("in"in s)&&(V(s.target)||we(s.target))}),i=e===Be?"the transient event":"event '".concat(e,"'");ie(!n,"One or more transitions for ".concat(i," on state '").concat(t.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")},Os=function(){function t(e,r,n,i){n===void 0&&(n="context"in e?e.context:void 0);var s=this,o;this.config=e,this._context=n,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(As(),r),this.parent=i==null?void 0:i.parent,this.key=this.config.key||(i==null?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:Jr),this.id=this.config.id||z([this.machine.key],j(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(o=this.config.schema)!==null&&o!==void 0?o:{},this.description=this.config.description,Q||ie(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?Xe(this.config.states,function(u,a){var c,h=new t(u,{},void 0,{parent:s,key:a});return Object.assign(s.idMap,T((c={},c[h.id]=h,c),h.idMap)),h}):Ge;var l=0;function d(u){var a,c;u.order=l++;try{for(var h=M(yn(u)),f=h.next();!f.done;f=h.next()){var p=f.value;d(p)}}catch(m){a={error:m}}finally{try{f&&!f.done&&(c=h.return)&&c.call(h)}finally{if(a)throw a.error}}}d(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(u){var a=u.event;return a===Be}):Be in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=pe(this.config.entry||this.config.onEntry).map(function(u){return je(u)}),this.onExit=pe(this.config.exit||this.config.onExit).map(function(u){return je(u)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=pe(this.config.invoke).map(function(u,a){var c,h;if(we(u)){var f=At(s.id,a);return s.machine.options.services=T((c={},c[f]=u,c),s.machine.options.services),Rt({src:f,id:f})}else if(V(u.src)){var f=u.id||At(s.id,a);return Rt(T(T({},u),{id:f,src:u.src}))}else if(we(u.src)||$(u.src)){var f=u.id||At(s.id,a);return s.machine.options.services=T((h={},h[f]=u.src,h),s.machine.options.services),Rt(T(T({id:f},u),{src:f}))}else{var p=u.src;return Rt(T(T({id:At(s.id,a)},u),{src:p}))}}),this.activities=pe(this.config.activities).concat(this.invoke).map(function(u){return Ot(u)}),this.transition=this.transition.bind(this),this.tags=pe(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||En(this).forEach(function(e){return e.on})},t.prototype.withConfig=function(e,r){var n=this.options,i=n.actions,s=n.activities,o=n.guards,l=n.services,d=n.delays;return new t(this.config,{actions:T(T({},i),e.actions),activities:T(T({},s),e.activities),guards:T(T({},o),e.guards),services:T(T({},l),e.services),delays:T(T({},d),e.delays)},r!=null?r:this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return $(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:Xe(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(r,n){return r[n.eventType]=r[n.eventType]||[],r[n.eventType].push(n),r},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var r=e===Be,n=this.transitions.filter(function(i){var s=i.eventType===e;return r?s:s||i.eventType===at});return this.__cache.candidates[e]=n,n},t.prototype.getDelayedTransitions=function(){var e=this,r=this.config.after;if(!r)return[];var n=function(s,o){var l=$(s)?"".concat(e.id,":delay[").concat(o,"]"):s,d=mn(l,e.id);return e.onEntry.push(Ne(d,{delay:s})),e.onExit.push(dn(d)),d},i=Me(r)?r.map(function(s,o){var l=n(s.delay,o);return T(T({},s),{event:l})}):X(Object.keys(r).map(function(s,o){var l=r[s],d=V(l)?{target:l}:l,u=isNaN(+s)?s:+s,a=n(u,o);return pe(d).map(function(c){return T(T({},c),{event:a,delay:u})})}));return i.map(function(s){var o=s.delay;return T(T({},e.formatTransition(s)),{delay:o})})},t.prototype.getStateNodes=function(e){var r,n=this;if(!e)return[];var i=e instanceof ve?e.value:Qe(e,this.delimiter);if(V(i)){var s=this.getStateNode(i).initial;return s!==void 0?this.getStateNodes((r={},r[i]=s,r)):[this,this.states[i]]}var o=Object.keys(i),l=[this];return l.push.apply(l,z([],j(X(o.map(function(d){return n.getStateNode(d).getStateNodes(i[d])}))),!1)),l},t.prototype.handles=function(e){var r=Qr(e);return this.events.includes(r)},t.prototype.resolveState=function(e){var r=e instanceof ve?e:ve.create(e),n=Array.from(it([],this.getStateNodes(r.value)));return new ve(T(T({},r),{value:this.resolve(r.value),configuration:n,done:_t(n,this),tags:Sn(n),machine:this.machine}))},t.prototype.transitionLeafNode=function(e,r,n){var i=this.getStateNode(e),s=i.next(r,n);return!s||!s.transitions.length?this.next(r,n):s},t.prototype.transitionCompoundNode=function(e,r,n){var i=Object.keys(e),s=this.getStateNode(i[0]),o=s._transition(e[i[0]],r,n);return!o||!o.transitions.length?this.next(r,n):o},t.prototype.transitionParallelNode=function(e,r,n){var i,s,o={};try{for(var l=M(Object.keys(e)),d=l.next();!d.done;d=l.next()){var u=d.value,a=e[u];if(a){var c=this.getStateNode(u),h=c._transition(a,r,n);h&&(o[u]=h)}}}catch(E){i={error:E}}finally{try{d&&!d.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}var f=Object.keys(o).map(function(E){return o[E]}),p=X(f.map(function(E){return E.transitions})),m=f.some(function(E){return E.transitions.length>0});if(!m)return this.next(r,n);var k=X(Object.keys(o).map(function(E){return o[E].configuration}));return{transitions:p,exitSet:X(f.map(function(E){return E.exitSet})),configuration:k,source:r,actions:X(Object.keys(o).map(function(E){return o[E].actions}))}},t.prototype._transition=function(e,r,n){return V(e)?this.transitionLeafNode(e,r,n):Object.keys(e).length===1?this.transitionCompoundNode(e,r,n):this.transitionParallelNode(e,r,n)},t.prototype.getTransitionData=function(e,r){return this._transition(e.value,e,ae(r))},t.prototype.next=function(e,r){var n,i,s=this,o=r.name,l=[],d=[],u;try{for(var a=M(this.getCandidates(o)),c=a.next();!c.done;c=a.next()){var h=c.value,f=h.cond,p=h.in,m=e.context,k=p?V(p)&&qe(p)?e.matches(Qe(this.getStateNodeById(p).path,this.delimiter)):nr(Qe(p,this.delimiter),Mi(this.path.slice(0,-2))(e.value)):!0,E=!1;try{E=!f||sn(this.machine,f,m,r,e)}catch(O){throw new Error("Unable to evaluate guard '".concat(f.name||f.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,`':
`).concat(O.message))}if(E&&k){h.target!==void 0&&(d=h.target),l.push.apply(l,z([],j(h.actions),!1)),u=h;break}}}catch(O){n={error:O}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}if(u){if(!d.length)return{transitions:[u],exitSet:[],configuration:e.value?[this]:[],source:e,actions:l};var w=X(d.map(function(O){return s.getRelativeStateNodes(O,e.historyValue)})),x=!!u.internal;return{transitions:[u],exitSet:x?[]:X(d.map(function(O){return s.getPotentiallyReenteringNodes(O)})),configuration:w,source:e,actions:l}}},t.prototype.getPotentiallyReenteringNodes=function(e){if(this.order<e.order)return[this];for(var r=[],n=this,i=e;n&&n!==i;)r.push(n),n=n.parent;return n!==i?[]:(r.push(i),r)},t.prototype.getActions=function(e,r,n,i,s,o,l){var d,u,a,c,h=this,f=o?it([],this.getStateNodes(o.value)):[],p=new Set;try{for(var m=M(Array.from(e).sort(function(R,K){return R.order-K.order})),k=m.next();!k.done;k=m.next()){var E=k.value;(!st(f,E)||st(n.exitSet,E)||E.parent&&p.has(E.parent))&&p.add(E)}}catch(R){d={error:R}}finally{try{k&&!k.done&&(u=m.return)&&u.call(m)}finally{if(d)throw d.error}}try{for(var w=M(f),x=w.next();!x.done;x=w.next()){var E=x.value;(!st(e,E)||st(n.exitSet,E.parent))&&n.exitSet.push(E)}}catch(R){a={error:R}}finally{try{x&&!x.done&&(c=w.return)&&c.call(w)}finally{if(a)throw a.error}}n.exitSet.sort(function(R,K){return K.order-R.order});var O=Array.from(p).sort(function(R,K){return R.order-K.order}),F=new Set(n.exitSet),U=X(O.map(function(R){var K=[];if(R.type!=="final")return K;var te=R.parent;if(!te.parent)return K;K.push(et(R.id,R.doneData),et(te.id,R.doneData?kt(R.doneData,i,s):void 0));var W=te.parent;return W.type==="parallel"&&nt(W).every(function(Ce){return _t(n.configuration,Ce)})&&K.push(et(W.id)),K})),P=O.map(function(R){var K=R.onEntry,te=R.activities.map(function(W){return hn(W)});return{type:"entry",actions:ke(l?z(z([],j(K),!1),j(te),!1):z(z([],j(te),!1),j(K),!1),h.machine.options.actions)}}).concat({type:"state_done",actions:U.map(function(R){return an(R)})}),H=Array.from(F).map(function(R){return{type:"exit",actions:ke(z(z([],j(R.onExit),!1),j(R.activities.map(function(K){return fn(K)})),!1),h.machine.options.actions)}}),L=H.concat({type:"transition",actions:ke(n.actions,this.machine.options.actions)}).concat(P);if(r){var Z=ke(X(z([],j(e),!1).sort(function(R,K){return K.order-R.order}).map(function(R){return R.onExit})),this.machine.options.actions).filter(function(R){return!sr(R)});return L.concat({type:"stop",actions:Z})}return L},t.prototype.transition=function(e,r,n,i){e===void 0&&(e=this.initialState);var s=ae(r),o;if(e instanceof ve)o=n===void 0?e:this.resolveState(ve.from(e,n));else{var l=V(e)?this.resolve(St(this.getResolvedPath(e))):this.resolve(e),d=n!=null?n:this.machine.context;o=this.resolveState(ve.from(l,d))}if(!Q&&s.name===at)throw new Error("An event cannot have the wildcard type ('".concat(at,"')"));if(this.strict&&!this.events.includes(s.name)&&!ji(s.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(s.name,"'"));var u=this._transition(o.value,o,s)||{transitions:[],configuration:[],exitSet:[],source:o,actions:[]},a=it([],this.getStateNodes(o.value)),c=u.configuration.length?it(a,u.configuration):a;return u.configuration=z([],j(c),!1),this.resolveTransition(u,o,o.context,i,s)},t.prototype.resolveRaisedTransition=function(e,r,n,i){var s,o=e.actions;return e=this.transition(e,r,void 0,i),e._event=n,e.event=n.data,(s=e.actions).unshift.apply(s,z([],j(o),!1)),e},t.prototype.resolveTransition=function(e,r,n,i,s){var o,l,d,u,a=this;s===void 0&&(s=be);var c=e.configuration,h=!r||e.transitions.length>0,f=h?e.configuration:r?r.configuration:[],p=_t(f,this),m=h?ds(this.machine,c):void 0,k=r?r.historyValue?r.historyValue:e.source?this.machine.historyValue(r.value):void 0:void 0,E=this.getActions(new Set(f),p,e,n,s,r,i),w=r?T({},r.activities):{};try{for(var x=M(E),O=x.next();!O.done;O=x.next()){var F=O.value;try{for(var U=(d=void 0,M(F.actions)),P=U.next();!P.done;P=U.next()){var H=P.value;H.type===pt?w[H.activity.id||H.activity.type]=H:H.type===vt&&(w[H.activity.id||H.activity.type]=!1)}}catch(he){d={error:he}}finally{try{P&&!P.done&&(u=U.return)&&u.call(U)}finally{if(d)throw d.error}}}}catch(he){o={error:he}}finally{try{O&&!O.done&&(l=x.return)&&l.call(x)}finally{if(o)throw o.error}}var L=j(rt(this,r,n,s,E,i,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),Z=L[0],R=L[1],K=j(Vi(Z,sr),2),te=K[0],W=K[1],Ce=Z.filter(function(he){var ne;return he.type===pt&&((ne=he.activity)===null||ne===void 0?void 0:ne.type)===yt}),Ue=Ce.reduce(function(he,ne){return he[ne.activity.id]=as(ne.activity,a.machine,R,s),he},r?T({},r.children):{}),v=new ve({value:m||r.value,context:R,_event:s,_sessionid:r?r._sessionid:null,historyValue:m?k?Bi(k,m):void 0:r?r.historyValue:void 0,history:!m||e.source?r:void 0,actions:m?W:[],activities:m?w:r?r.activities:{},events:[],configuration:f,transitions:e.transitions,children:Ue,done:p,tags:Sn(f),machine:this}),S=n!==R;v.changed=s.name===Et||S;var N=v.history;N&&delete N.history;var Y=!p&&(this._transient||c.some(function(he){return he._transient}));if(!h&&(!Y||s.name===Be))return v;var B=v;if(!p)for(Y&&(B=this.resolveRaisedTransition(B,{type:Hr},s,i));te.length;){var G=te.shift();B=this.resolveRaisedTransition(B,G._event,s,i)}var ze=B.changed||(N?!!B.actions.length||S||typeof N.value!=typeof B.value||!wn(B.value,N.value):void 0);return B.changed=ze,B.history=N,B},t.prototype.getStateNode=function(e){if(qe(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var r=this.states[e];if(!r)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return r},t.prototype.getStateNodeById=function(e){var r=qe(e)?e.slice(hr.length):e;if(r===this.id)return this;var n=this.machine.idMap[r];if(!n)throw new Error("Child state node '#".concat(r,"' does not exist on machine '").concat(this.id,"'"));return n},t.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&qe(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var r=ir(e,this.delimiter).slice(),n=this;r.length;){var i=r.shift();if(!i.length)break;n=n.getStateNode(i)}return n},t.prototype.resolve=function(e){var r,n=this;if(!e)return this.initialStateValue||Ge;switch(this.type){case"parallel":return Xe(this.initialStateValue,function(s,o){return s?n.getStateNode(o).resolve(e[o]||s):Ge});case"compound":if(V(e)){var i=this.getStateNode(e);return i.type==="parallel"||i.type==="compound"?(r={},r[e]=i.initialStateValue,r):e}return Object.keys(e).length?Xe(e,function(s,o){return s?n.getStateNode(o).resolve(s):Ge}):this.initialStateValue||{};default:return e||Ge}},t.prototype.getResolvedPath=function(e){if(qe(e)){var r=this.machine.idMap[e.slice(hr.length)];if(!r)throw new Error("Unable to find state node '".concat(e,"'"));return r.path}return ir(e,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var r;if(this.type==="parallel")r=Xr(this.states,function(n){return n.initialStateValue||Ge},function(n){return n.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));r=Nt(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else r={};return this.__cache.initialStateValue=r,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(e,r){this._init();var n=this.getStateNodes(e);return this.resolveTransition({configuration:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,r!=null?r:this.machine.context,void 0)},Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var e;if(this.type==="history"){var r=this.config;V(r.target)?e=qe(r.target)?St(this.machine.getStateNodeById(r.target).path.slice(this.path.length-1)):r.target:e=r.target}return e},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(e,r,n){return n===void 0&&(n=!0),n?e.type==="history"?e.resolveHistory(r):e.initialStateNodes:[e]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var e=this;if(Nt(this))return[this];if(this.type==="compound"&&!this.initial)return Q||ie(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this];var r=wt(this.initialStateValue);return X(r.map(function(n){return e.getFromRelativePath(n)}))},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var r=j(e),n=r[0],i=r.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var s=this.getStateNode(n);if(s.type==="history")return s.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(i)},t.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:Xr(this.states,function(r,n){if(!e)return r.historyValue();var i=V(e)?void 0:e[n];return r.historyValue(i||r.initialStateValue)},function(r){return!r.history})}},t.prototype.resolveHistory=function(e){var r=this;if(this.type!=="history")return[this];var n=this.parent;if(!e){var i=this.target;return i?X(wt(i).map(function(o){return n.getFromRelativePath(o)})):n.initialStateNodes}var s=Fi(n.path,"states")(e).current;return V(s)?[n.getStateNode(s)]:X(wt(s).map(function(o){return r.history==="deep"?n.getFromRelativePath(o):[n.states[o[0]]]}))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var e=this,r=X(Object.keys(this.states).map(function(n){return e.states[n].stateIds}));return[this.id].concat(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var e,r,n,i;if(this.__cache.events)return this.__cache.events;var s=this.states,o=new Set(this.ownEvents);if(s)try{for(var l=M(Object.keys(s)),d=l.next();!d.done;d=l.next()){var u=d.value,a=s[u];if(a.states)try{for(var c=(n=void 0,M(a.events)),h=c.next();!h.done;h=c.next()){var f=h.value;o.add("".concat(f))}}catch(p){n={error:p}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}}}catch(p){e={error:p}}finally{try{d&&!d.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(r){return!(!r.target&&!r.actions.length&&r.internal)}).map(function(r){return r.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(e){var r=this;if(e!==void 0)return e.map(function(n){if(!V(n))return n;var i=n[0]===r.delimiter;if(i&&!r.parent)return r.getStateNodeByPath(n.slice(1));var s=i?r.key+n:n;if(r.parent)try{var o=r.parent.getStateNodeByPath(s);return o}catch(l){throw new Error("Invalid transition definition for state node '".concat(r.id,`':
`).concat(l.message))}else return r.getStateNodeByPath(s)})},t.prototype.formatTransition=function(e){var r=this,n=Ki(e.target),i="internal"in e?e.internal:n?n.some(function(d){return V(d)&&d[0]===r.delimiter}):!0,s=this.machine.options.guards,o=this.resolveTarget(n),l=T(T({},e),{actions:ke(pe(e.actions)),cond:nn(e.cond,s),target:o,source:this,internal:i,eventType:e.event,toJSON:function(){return T(T({},l),{target:l.target?l.target.map(function(d){return"#".concat(d.id)}):void 0,source:"#".concat(r.id)})}});return l},t.prototype.formatTransitions=function(){var e,r,n=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var s=this.config.on,o=at,l=s[o],d=l===void 0?[]:l,u=Xt(s,[typeof o=="symbol"?o:o+""]);i=X(Object.keys(u).map(function(w){!Q&&w===Be&&ie(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(n.id,'".'));var x=Fe(w,u[w]);return Q||Is(n,w,x),x}).concat(Fe(at,d)))}var a=this.config.always?Fe("",this.config.always):[],c=this.config.onDone?Fe(String(et(this.id)),this.config.onDone):[];Q||ie(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var h=X(this.invoke.map(function(w){var x=[];return w.onDone&&x.push.apply(x,z([],j(Fe(String(tt(w.id)),w.onDone)),!1)),w.onError&&x.push.apply(x,z([],j(Fe(String($e(w.id)),w.onError)),!1)),x})),f=this.after,p=X(z(z(z(z([],j(c),!1),j(h),!1),j(i),!1),j(a),!1).map(function(w){return pe(w).map(function(x){return n.formatTransition(x)})}));try{for(var m=M(f),k=m.next();!k.done;k=m.next()){var E=k.value;p.push(E)}}catch(w){e={error:w}}finally{try{k&&!k.done&&(r=m.return)&&r.call(m)}finally{if(e)throw e.error}}return p},t}(),xn=!1;function Oe(t,e){return!Q&&!("predictableActionArguments"in t)&&!xn&&(xn=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new Os(t,e)}var D=vn,se=Ne;/*! js-cookie v3.0.5 | MIT */function Dt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}var bs={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function fr(t,e){function r(i,s,o){if(typeof document!="undefined"){o=Dt({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var l="";for(var d in o)o[d]&&(l+="; "+d,o[d]!==!0&&(l+="="+o[d].split(";")[0]));return document.cookie=i+"="+t.write(s,i)+l}}function n(i){if(!(typeof document=="undefined"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],o={},l=0;l<s.length;l++){var d=s[l].split("="),u=d.slice(1).join("=");try{var a=decodeURIComponent(d[0]);if(o[a]=t.read(u,a),i===a)break}catch{}}return i?o[i]:o}}return Object.create({set:r,get:n,remove:function(i,s){r(i,"",Dt({},s,{expires:-1}))},withAttributes:function(i){return fr(this.converter,Dt({},this.attributes,i))},withConverter:function(i){return fr(Dt({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var pr=fr(bs,{path:"/"}),vr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function mr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ns(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var gr={exports:{}};(function(t,e){(function(r){function n(i){var s=i&&i.Promise||r.Promise,o=i&&i.XMLHttpRequest||r.XMLHttpRequest;return function(){var l=Object.create(r,{fetch:{value:void 0,writable:!0}});return function(d,u){u(e)}(this,function(d){var u=typeof l!="undefined"&&l||typeof self!="undefined"&&self||typeof u!="undefined"&&u,a={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function c(v){return v&&DataView.prototype.isPrototypeOf(v)}if(a.arrayBuffer)var h=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(v){return v&&h.indexOf(Object.prototype.toString.call(v))>-1};function p(v){if(typeof v!="string"&&(v=String(v)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(v)||v==="")throw new TypeError("Invalid character in header field name");return v.toLowerCase()}function m(v){return typeof v!="string"&&(v=String(v)),v}function k(v){var S={next:function(){var N=v.shift();return{done:N===void 0,value:N}}};return a.iterable&&(S[Symbol.iterator]=function(){return S}),S}function E(v){this.map={},v instanceof E?v.forEach(function(S,N){this.append(N,S)},this):Array.isArray(v)?v.forEach(function(S){this.append(S[0],S[1])},this):v&&Object.getOwnPropertyNames(v).forEach(function(S){this.append(S,v[S])},this)}E.prototype.append=function(v,S){v=p(v),S=m(S);var N=this.map[v];this.map[v]=N?N+", "+S:S},E.prototype.delete=function(v){delete this.map[p(v)]},E.prototype.get=function(v){return v=p(v),this.has(v)?this.map[v]:null},E.prototype.has=function(v){return this.map.hasOwnProperty(p(v))},E.prototype.set=function(v,S){this.map[p(v)]=m(S)},E.prototype.forEach=function(v,S){for(var N in this.map)this.map.hasOwnProperty(N)&&v.call(S,this.map[N],N,this)},E.prototype.keys=function(){var v=[];return this.forEach(function(S,N){v.push(N)}),k(v)},E.prototype.values=function(){var v=[];return this.forEach(function(S){v.push(S)}),k(v)},E.prototype.entries=function(){var v=[];return this.forEach(function(S,N){v.push([N,S])}),k(v)},a.iterable&&(E.prototype[Symbol.iterator]=E.prototype.entries);function w(v){if(v.bodyUsed)return s.reject(new TypeError("Already read"));v.bodyUsed=!0}function x(v){return new s(function(S,N){v.onload=function(){S(v.result)},v.onerror=function(){N(v.error)}})}function O(v){var S=new FileReader,N=x(S);return S.readAsArrayBuffer(v),N}function F(v){var S=new FileReader,N=x(S);return S.readAsText(v),N}function U(v){for(var S=new Uint8Array(v),N=new Array(S.length),Y=0;Y<S.length;Y++)N[Y]=String.fromCharCode(S[Y]);return N.join("")}function P(v){if(v.slice)return v.slice(0);var S=new Uint8Array(v.byteLength);return S.set(new Uint8Array(v)),S.buffer}function H(){return this.bodyUsed=!1,this._initBody=function(v){this.bodyUsed=this.bodyUsed,this._bodyInit=v,v?typeof v=="string"?this._bodyText=v:a.blob&&Blob.prototype.isPrototypeOf(v)?this._bodyBlob=v:a.formData&&FormData.prototype.isPrototypeOf(v)?this._bodyFormData=v:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)?this._bodyText=v.toString():a.arrayBuffer&&a.blob&&c(v)?(this._bodyArrayBuffer=P(v.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(v)||f(v))?this._bodyArrayBuffer=P(v):this._bodyText=v=Object.prototype.toString.call(v):this._bodyText="",this.headers.get("content-type")||(typeof v=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var v=w(this);if(v)return v;if(this._bodyBlob)return s.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return s.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return s.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var v=w(this);return v||(ArrayBuffer.isView(this._bodyArrayBuffer)?s.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):s.resolve(this._bodyArrayBuffer))}else return this.blob().then(O)}),this.text=function(){var v=w(this);if(v)return v;if(this._bodyBlob)return F(this._bodyBlob);if(this._bodyArrayBuffer)return s.resolve(U(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return s.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(K)}),this.json=function(){return this.text().then(JSON.parse)},this}var L=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Z(v){var S=v.toUpperCase();return L.indexOf(S)>-1?S:v}function R(v,S){if(!(this instanceof R))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');S=S||{};var N=S.body;if(v instanceof R){if(v.bodyUsed)throw new TypeError("Already read");this.url=v.url,this.credentials=v.credentials,S.headers||(this.headers=new E(v.headers)),this.method=v.method,this.mode=v.mode,this.signal=v.signal,!N&&v._bodyInit!=null&&(N=v._bodyInit,v.bodyUsed=!0)}else this.url=String(v);if(this.credentials=S.credentials||this.credentials||"same-origin",(S.headers||!this.headers)&&(this.headers=new E(S.headers)),this.method=Z(S.method||this.method||"GET"),this.mode=S.mode||this.mode||null,this.signal=S.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&N)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(N),(this.method==="GET"||this.method==="HEAD")&&(S.cache==="no-store"||S.cache==="no-cache")){var Y=/([?&])_=[^&]*/;if(Y.test(this.url))this.url=this.url.replace(Y,"$1_="+new Date().getTime());else{var B=/\?/;this.url+=(B.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}R.prototype.clone=function(){return new R(this,{body:this._bodyInit})};function K(v){var S=new FormData;return v.trim().split("&").forEach(function(N){if(N){var Y=N.split("="),B=Y.shift().replace(/\+/g," "),G=Y.join("=").replace(/\+/g," ");S.append(decodeURIComponent(B),decodeURIComponent(G))}}),S}function te(v){var S=new E,N=v.replace(/\r?\n[\t ]+/g," ");return N.split("\r").map(function(Y){return Y.indexOf(`
`)===0?Y.substr(1,Y.length):Y}).forEach(function(Y){var B=Y.split(":"),G=B.shift().trim();if(G){var ze=B.join(":").trim();S.append(G,ze)}}),S}H.call(R.prototype);function W(v,S){if(!(this instanceof W))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');S||(S={}),this.type="default",this.status=S.status===void 0?200:S.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in S?S.statusText:"",this.headers=new E(S.headers),this.url=S.url||"",this._initBody(v)}H.call(W.prototype),W.prototype.clone=function(){return new W(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new E(this.headers),url:this.url})},W.error=function(){var v=new W(null,{status:0,statusText:""});return v.type="error",v};var Ce=[301,302,303,307,308];W.redirect=function(v,S){if(Ce.indexOf(S)===-1)throw new RangeError("Invalid status code");return new W(null,{status:S,headers:{location:v}})},d.DOMException=u.DOMException;try{new d.DOMException}catch{d.DOMException=function(S,N){this.message=S,this.name=N;var Y=Error(S);this.stack=Y.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function Ue(v,S){return new s(function(N,Y){var B=new R(v,S);if(B.signal&&B.signal.aborted)return Y(new d.DOMException("Aborted","AbortError"));var G=new o;function ze(){G.abort()}G.onload=function(){var ne={status:G.status,statusText:G.statusText,headers:te(G.getAllResponseHeaders()||"")};ne.url="responseURL"in G?G.responseURL:ne.headers.get("X-Request-URL");var Wt="response"in G?G.response:G.responseText;setTimeout(function(){N(new W(Wt,ne))},0)},G.onerror=function(){setTimeout(function(){Y(new TypeError("Network request failed"))},0)},G.ontimeout=function(){setTimeout(function(){Y(new TypeError("Network request failed"))},0)},G.onabort=function(){setTimeout(function(){Y(new d.DOMException("Aborted","AbortError"))},0)};function he(ne){try{return ne===""&&u.location.href?u.location.href:ne}catch{return ne}}G.open(B.method,he(B.url),!0),B.credentials==="include"?G.withCredentials=!0:B.credentials==="omit"&&(G.withCredentials=!1),"responseType"in G&&(a.blob?G.responseType="blob":a.arrayBuffer&&B.headers.get("Content-Type")&&B.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(G.responseType="arraybuffer")),S&&typeof S.headers=="object"&&!(S.headers instanceof E)?Object.getOwnPropertyNames(S.headers).forEach(function(ne){G.setRequestHeader(ne,m(S.headers[ne]))}):B.headers.forEach(function(ne,Wt){G.setRequestHeader(Wt,ne)}),B.signal&&(B.signal.addEventListener("abort",ze),G.onreadystatechange=function(){G.readyState===4&&B.signal.removeEventListener("abort",ze)}),G.send(typeof B._bodyInit=="undefined"?null:B._bodyInit)})}Ue.polyfill=!0,u.fetch||(u.fetch=Ue,u.Headers=E,u.Request=R,u.Response=W),d.Headers=E,d.Request=R,d.Response=W,d.fetch=Ue,Object.defineProperty(d,"__esModule",{value:!0})}),{fetch:l.fetch,Headers:l.Headers,Request:l.Request,Response:l.Response,DOMException:l.DOMException}}()}t.exports=n})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:vr)})(gr,gr.exports);var _s=gr.exports;const yr=mr(_s),ct="nhostRefreshToken",Pt="nhostRefreshTokenId",He="nhostRefreshTokenExpiresAt",Rs=3,Ds=60,An=5,In=0,On=1,Ee=10,Ct=20;let Re=class extends Error{constructor(e){super(e.message),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),e instanceof Error?(this.name=e.name,this.error={error:e.name,status:On,message:e.message}):(this.name=e.error,this.error=e)}};const Te={status:Ee,error:"invalid-email",message:"Email is incorrectly formatted"},Ps={status:Ee,error:"invalid-mfa-type",message:"MFA type is invalid"},Cs={status:Ee,error:"invalid-mfa-code",message:"MFA code is invalid"},Er={status:Ee,error:"invalid-password",message:"Password is incorrectly formatted"},bn={status:Ee,error:"invalid-phone-number",message:"Phone number is incorrectly formatted"},Us={status:Ee,error:"invalid-mfa-ticket",message:"MFA ticket is invalid"},Ls={status:Ee,error:"no-mfa-ticket",message:"No MFA ticket has been provided"},Ms={status:Ee,error:"no-refresh-token",message:"No refresh token has been provided"},Fs={status:Ct,error:"refresher-already-running",message:"The token refresher is already running. You must wait until is has finished before submitting a new token."},ue={status:Ct,error:"already-signed-in",message:"User is already signed in"},js={status:Ct,error:"unauthenticated-user",message:"User is not authenticated"},$s={status:Ct,error:"unverified-user",message:"Email needs verification"},Vs={status:Ee,error:"invalid-refresh-token",message:"Invalid or expired refresh token"},Bs={status:On,error:"invalid-sign-in-method",message:"Invalid sign-in method"},Tr={user:null,mfa:null,accessToken:{value:null,expiresAt:null,expiresInSeconds:15},refreshTimer:{startedAt:null,attempts:0,lastAttempt:null},refreshToken:{value:null},importTokenAttempts:0,errors:{}};function Gs(t){return new TextEncoder().encode(t)}function xe(t){const e=new Uint8Array(t);let r="";for(const n of e)r+=String.fromCharCode(n);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Sr(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4,n=e.padEnd(e.length+r,"="),i=atob(n),s=new ArrayBuffer(i.length),o=new Uint8Array(s);for(let l=0;l<i.length;l++)o[l]=i.charCodeAt(l);return s}function Nn(){return(window==null?void 0:window.PublicKeyCredential)!==void 0&&typeof window.PublicKeyCredential=="function"}function _n(t){const{id:e}=t;return{...t,id:Sr(e),transports:t.transports}}function Rn(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}class ce extends Error{constructor({message:e,code:r,cause:n,name:i}){super(e,{cause:n}),this.name=i!=null?i:n.name,this.code=r}}function qs({error:t,options:e}){var r,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ce({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)==null?void 0:r.requireResidentKey)===!0)return new ce({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(((n=i.authenticatorSelection)==null?void 0:n.userVerification)==="required")return new ce({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new ce({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new ce({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(s=>s.type==="public-key").length===0?new ce({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new ce({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(Rn(s)){if(i.rp.id!==s)return new ce({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ce({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new ce({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new ce({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return t}class Hs{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Dn=new Hs,Ks=["cross-platform","platform"];function Pn(t){if(t&&!(Ks.indexOf(t)<0))return t}async function Cn(t){var e;if(!Nn())throw new Error("WebAuthn is not supported in this browser");const r={publicKey:{...t,challenge:Sr(t.challenge),user:{...t.user,id:Gs(t.user.id)},excludeCredentials:(e=t.excludeCredentials)==null?void 0:e.map(_n)}};r.signal=Dn.createNewAbortSignal();let n;try{n=await navigator.credentials.create(r)}catch(h){throw qs({error:h,options:r})}if(!n)throw new Error("Registration was not completed");const{id:i,rawId:s,response:o,type:l}=n;let d;typeof o.getTransports=="function"&&(d=o.getTransports());let u;if(typeof o.getPublicKeyAlgorithm=="function")try{u=o.getPublicKeyAlgorithm()}catch(h){wr("getPublicKeyAlgorithm()",h)}let a;if(typeof o.getPublicKey=="function")try{const h=o.getPublicKey();h!==null&&(a=xe(h))}catch(h){wr("getPublicKey()",h)}let c;if(typeof o.getAuthenticatorData=="function")try{c=xe(o.getAuthenticatorData())}catch(h){wr("getAuthenticatorData()",h)}return{id:i,rawId:xe(s),response:{attestationObject:xe(o.attestationObject),clientDataJSON:xe(o.clientDataJSON),transports:d,publicKeyAlgorithm:u,publicKey:a,authenticatorData:c},type:l,clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:Pn(n.authenticatorAttachment)}}function wr(t,e){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${t}. You should report this error to them.
`,e)}function Ys(t){return new TextDecoder("utf-8").decode(t)}function zs(){const t=window.PublicKeyCredential;return t.isConditionalMediationAvailable===void 0?new Promise(e=>e(!1)):t.isConditionalMediationAvailable()}function Js({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ce({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new ce({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(Rn(n)){if(r.rpId!==n)return new ce({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ce({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new ce({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return t}async function kr(t,e=!1){var r,n;if(!Nn())throw new Error("WebAuthn is not supported in this browser");let i;((r=t.allowCredentials)==null?void 0:r.length)!==0&&(i=(n=t.allowCredentials)==null?void 0:n.map(_n));const s={...t,challenge:Sr(t.challenge),allowCredentials:i},o={};if(e){if(!await zs())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');o.mediation="conditional",s.allowCredentials=[]}o.publicKey=s,o.signal=Dn.createNewAbortSignal();let l;try{l=await navigator.credentials.get(o)}catch(f){throw Js({error:f,options:o})}if(!l)throw new Error("Authentication was not completed");const{id:d,rawId:u,response:a,type:c}=l;let h;return a.userHandle&&(h=Ys(a.userHandle)),{id:d,rawId:xe(u),response:{authenticatorData:xe(a.authenticatorData),clientDataJSON:xe(a.clientDataJSON),signature:xe(a.signature),userHandle:h},type:c,clientExtensionResults:l.getClientExtensionResults(),authenticatorAttachment:Pn(l.authenticatorAttachment)}}const Ut=typeof window!="undefined",Lt=new Map,Ws=t=>{var e;return Ut&&typeof localStorage!="undefined"?localStorage.getItem(t):(e=Lt.get(t))!=null?e:null},Qs=(t,e)=>{Ut&&typeof localStorage!="undefined"?e?localStorage.setItem(t,e):localStorage.removeItem(t):e?Lt.set(t,e):Lt.has(t)&&Lt.delete(t)},Xs=(t,e)=>{if(t==="localStorage"||t==="web")return Ws;if(t==="cookie")return r=>{var n;return Ut&&(n=pr.get(r))!=null?n:null};if(!e)throw Error(`clientStorageType is set to '${t}' but no clientStorage has been given`);if(t==="react-native")return r=>{var n;return(n=e.getItem)==null?void 0:n.call(e,r)};if(t==="capacitor")return r=>{var n;return(n=e.get)==null?void 0:n.call(e,{key:r})};if(t==="expo-secure-storage")return r=>{var n;return(n=e.getItemAsync)==null?void 0:n.call(e,r)};if(t==="custom"){if(e.getItem&&e.removeItem)return e.getItem;if(e.getItemAsync)return e.getItemAsync;throw Error(`clientStorageType is set to 'custom' but clientStorage is missing either "getItem" and "removeItem" properties or "getItemAsync" property`)}throw Error(`Unknown storage type: ${t}`)},Zs=(t,e)=>{if(t==="localStorage"||t==="web")return Qs;if(t==="cookie")return(r,n)=>{Ut&&(n?pr.set(r,n,{expires:30,sameSite:"lax",httpOnly:!1}):pr.remove(r))};if(!e)throw Error(`clientStorageType is set to '${t}' but no clienStorage has been given`);if(t==="react-native")return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(t==="capacitor")return(r,n)=>{var i,s;return n?(i=e.set)==null?void 0:i.call(e,{key:r,value:n}):(s=e.remove)==null?void 0:s.call(e,{key:r})};if(t==="expo-secure-storage")return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.deleteItemAsync)==null?void 0:s.call(e,r)};if(t==="custom"){if(!e.removeItem)throw Error("clientStorageType is set to 'custom' but clientStorage is missing a removeItem property");if(e.setItem)return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(e.setItemAsync)return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};throw Error("clientStorageType is set to 'custom' but clientStorage is missing setItem or setItemAsync property")}throw Error(`Unknown storage type: ${t}`)},Mt=t=>!t||!t.accessToken.value||!t.accessToken.expiresAt||!t.user?null:{accessToken:t.accessToken.value,accessTokenExpiresIn:(t.accessToken.expiresAt.getTime()-Date.now())/1e3,refreshToken:t.refreshToken.value,user:t.user},me=({accessToken:t,refreshToken:e,isError:r,user:n,error:i})=>r?{session:null,error:i}:n&&t?{session:{accessToken:t,accessTokenExpiresIn:0,refreshToken:e,user:n},error:null}:{session:null,error:null},Un=()=>typeof window!="undefined"&&typeof window.location!="undefined";let Ln=globalThis.fetch;typeof EdgeRuntime!="string"&&(Ln=yr().fetch);const Mn=async(t,e,{token:r,body:n,extraHeaders:i}={})=>{const s={"Content-Type":"application/json",Accept:"*/*"};r&&(s.Authorization=`Bearer ${r}`);const o={...s,...i},l={method:e,headers:o};n&&(l.body=JSON.stringify(n));try{const d=await Ln(t,l);if(!d.ok){const u=await d.json();return Promise.reject({error:u})}try{return{data:await d.json(),error:null}}catch{return console.warn(`Unexpected response: can't parse the response of the server at ${t}`),{data:"OK",error:null}}}catch{const d={message:"Network Error",status:In,error:"network"};return Promise.reject({error:d})}},fe=async(t,e,r,n)=>Mn(t,"POST",{token:r,body:e,extraHeaders:n}),eo=(t,e)=>Mn(t,"GET",{token:e}),Ft=(t,e)=>{const r=e&&Object.entries(e).map(([n,i])=>{const s=Array.isArray(i)?i.join(","):typeof i=="object"?JSON.stringify(i):i;return`${n}=${encodeURIComponent(s)}`}).join("&");return r?`${t}?${r}`:t},le=(t,e)=>{if(!(e!=null&&e.redirectTo))return e;const{redirectTo:r,...n}=e;if(!t)return r.startsWith("/")?n:e;const i=new URL(t),s=Object.fromEntries(new URLSearchParams(i.search)),o=new URL(r.startsWith("/")?i.origin+r:r),l=new URLSearchParams(o.search);let d=Object.fromEntries(l);r.startsWith("/")&&(d={...s,...d});let u=i.pathname;return o.pathname.length>1&&(u+=o.pathname.slice(1)),{...n,redirectTo:Ft(o.origin+u,d)}};function jt(t,e){var r;if(!e){if(typeof window=="undefined")return;e=((r=window.location)==null?void 0:r.href)||""}t=t.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&#]"+t+"(=([^&#]*)|&|#|$)"),i=n.exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function $t(t){var e;if(typeof window=="undefined")return;const r=window==null?void 0:window.location;if(r&&r){const n=new URLSearchParams(r.search),i=new URLSearchParams((e=r.hash)==null?void 0:e.slice(1));n.delete(t),i.delete(t);let s=window.location.pathname;Array.from(n).length&&(s+=`?${n.toString()}`),Array.from(i).length&&(s+=`#${i.toString()}`),window.history.pushState({},"",s)}}const Se=t=>!!t&&typeof t=="string"&&!!String(t).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),xr=t=>!!t&&typeof t=="string"&&t.length>=Rs,Fn=t=>!!t&&typeof t=="string",to=t=>t&&typeof t=="string"&&t.match(/^mfaTotp:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),ro=({backendUrl:t,clientUrl:e,broadcastKey:r,clientStorageType:n="web",clientStorage:i,refreshIntervalTime:s,autoRefreshToken:o=!0,autoSignIn:l=!0})=>{const d=Xs(n,i),u=Zs(n,i),a=async(c,h,f,p)=>(await fe(`${t}${c}`,h,f,p)).data;return Oe({schema:{context:{},events:{},services:{}},tsTypes:{},context:Tr,predictableActionArguments:!0,id:"nhost",type:"parallel",states:{authentication:{initial:"starting",on:{SESSION_UPDATE:[{cond:"hasSession",actions:["saveSession","resetTimer","reportTokenChanged"],target:".signedIn"}]},states:{starting:{tags:["loading"],always:{cond:"isSignedIn",target:"signedIn"},invoke:{id:"importRefreshToken",src:"importRefreshToken",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"signedIn"},{target:"signedOut"}],onError:[{cond:"shouldRetryImportToken",actions:"incrementTokenImportAttempts",target:"retryTokenImport"},{actions:["saveAuthenticationError"],target:"signedOut"}]}},retryTokenImport:{tags:["loading"],after:{RETRY_IMPORT_TOKEN_DELAY:"starting"}},signedOut:{initial:"noErrors",entry:"reportSignedOut",states:{noErrors:{},success:{},needsSmsOtp:{},needsMfa:{},failed:{},signingOut:{entry:["clearContextExceptTokens"],exit:["destroyAccessToken","destroyRefreshToken","reportTokenChanged"],invoke:{src:"signout",id:"signingOut",onDone:{target:"success"},onError:{target:"failed",actions:["saveAuthenticationError"]}}}},on:{SIGNIN_PASSWORD:"authenticating.password",SIGNIN_ANONYMOUS:"authenticating.anonymous",SIGNIN_SECURITY_KEY_EMAIL:"authenticating.securityKeyEmail",SIGNIN_SECURITY_KEY:"authenticating.securityKey",SIGNIN_MFA_TOTP:"authenticating.mfa.totp",SIGNIN_PAT:"authenticating.pat",SIGNIN_ID_TOKEN:"authenticating.idToken"}},authenticating:{entry:"resetErrors",states:{password:{invoke:{src:"signInPassword",id:"authenticateUserWithPassword",onDone:[{cond:"hasMfaTicket",actions:["saveMfaTicket"],target:"#nhost.authentication.signedOut.needsMfa"},{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"}],onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},pat:{invoke:{src:"signInPAT",id:"authenticateWithPAT",onDone:{actions:["savePATSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},idToken:{invoke:{src:"signInIdToken",id:"authenticateWithIdToken",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},anonymous:{invoke:{src:"signInAnonymous",id:"authenticateAnonymously",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},mfa:{states:{totp:{invoke:{src:"signInMfaTotp",id:"signInMfaTotp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:["saveAuthenticationError"],target:"#nhost.authentication.signedOut.failed"}}}}},securityKeyEmail:{invoke:{src:"signInSecurityKeyEmail",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},securityKey:{invoke:{src:"signInSecurityKey",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}}}},signedIn:{type:"parallel",entry:["reportSignedIn","cleanUrl","broadcastToken","resetErrors"],on:{SIGNOUT:"signedOut.signingOut"},states:{refreshTimer:{id:"timer",initial:"idle",states:{disabled:{type:"final"},stopped:{always:{cond:"noToken",target:"idle"}},idle:{always:[{cond:"isAutoRefreshDisabled",target:"disabled"},{cond:"isRefreshTokenPAT",target:"disabled"},{cond:"hasRefreshToken",target:"running"}]},running:{initial:"pending",entry:"resetTimer",states:{pending:{after:{1e3:{internal:!1,target:"pending"}},always:{cond:"refreshTimerShouldRefresh",target:"refreshing"}},refreshing:{invoke:{src:"refreshToken",id:"refreshToken",onDone:{actions:["saveSession","resetTimer","reportTokenChanged"],target:"pending"},onError:[{cond:"isUnauthorizedError",target:"#nhost.authentication.signedOut"},{actions:"saveRefreshAttempt",target:"pending"}]}}}}}}}}}},token:{initial:"idle",states:{idle:{on:{TRY_TOKEN:"running"},initial:"noErrors",states:{noErrors:{},error:{}}},running:{invoke:{src:"refreshToken",id:"authenticateWithToken",onDone:{actions:["saveSession","reportTokenChanged"],target:["#nhost.authentication.signedIn","idle.noErrors"]},onError:[{cond:"isSignedIn",target:"idle.error"},{actions:"saveAuthenticationError",target:["#nhost.authentication.signedOut.failed","idle.error"]}]}}}},registration:{initial:"incomplete",on:{SIGNED_IN:[{cond:"isAnonymous",target:".incomplete"},".complete"]},states:{incomplete:{on:{SIGNUP_EMAIL_PASSWORD:"emailPassword",SIGNUP_SECURITY_KEY:"securityKey",PASSWORDLESS_EMAIL:"passwordlessEmail",PASSWORDLESS_SMS:"passwordlessSms",PASSWORDLESS_SMS_OTP:"passwordlessSmsOtp",SIGNIN_EMAIL_OTP:"signInEmailOTP",VERIFY_EMAIL_OTP:"verifyEmailOTP"},initial:"noErrors",states:{noErrors:{},needsEmailVerification:{},needsOtp:{},failed:{}}},emailPassword:{entry:["resetErrors"],invoke:{src:"signUpEmailPassword",id:"signUpEmailPassword",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},securityKey:{entry:["resetErrors"],invoke:{src:"signUpSecurityKey",id:"signUpSecurityKey",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},passwordlessEmail:{entry:["resetErrors"],invoke:{src:"passwordlessEmail",id:"passwordlessEmail",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSms:{entry:["resetErrors"],invoke:{src:"passwordlessSms",id:"passwordlessSms",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSmsOtp:{entry:["resetErrors"],invoke:{src:"passwordlessSmsOtp",id:"passwordlessSmsOtp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},signInEmailOTP:{entry:["resetErrors"],invoke:{src:"signInEmailOTP",id:"signInEmailOTP",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},verifyEmailOTP:{entry:["resetErrors"],invoke:{src:"verifyEmailOTP",id:"verifyEmailOTP",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},complete:{on:{SIGNED_OUT:"incomplete"}}}}}},{actions:{reportSignedIn:se("SIGNED_IN"),reportSignedOut:se("SIGNED_OUT"),reportTokenChanged:se("TOKEN_CHANGED"),incrementTokenImportAttempts:D({importTokenAttempts:({importTokenAttempts:c})=>c+1}),clearContext:D(()=>(u(He,null),u(ct,null),u(Pt,null),{...Tr})),clearContextExceptTokens:D(({accessToken:c,refreshToken:h})=>({...Tr,accessToken:c,refreshToken:h})),saveSession:D({user:(c,{data:h})=>{var f;return((f=h==null?void 0:h.session)==null?void 0:f.user)||null},accessToken:(c,{data:h})=>{if(h.session){const{accessTokenExpiresIn:f,accessToken:p}=h.session,m=new Date(Date.now()+f*1e3);return u(He,m.toISOString()),{value:p,expiresAt:m,expiresInSeconds:f}}return u(He,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(c,{data:h})=>{var f,p;const m=((f=h.session)==null?void 0:f.refreshToken)||null,k=((p=h.session)==null?void 0:p.refreshTokenId)||null;return m&&u(ct,m),k&&u(Pt,k),{value:m}}}),savePATSession:D({user:(c,{data:h})=>{var f;return((f=h==null?void 0:h.session)==null?void 0:f.user)||null},accessToken:(c,{data:h})=>{if(h.session){const{accessTokenExpiresIn:f,accessToken:p}=h.session,m=new Date(Date.now()+f*1e3);return u(He,m.toISOString()),{value:p,expiresAt:m,expiresInSeconds:f}}return u(He,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(c,{data:h})=>{var f,p;const m=((f=h.session)==null?void 0:f.refreshToken)||null,k=((p=h.session)==null?void 0:p.refreshTokenId)||null;return m&&u(ct,m),k&&u(Pt,k),{value:m,isPAT:!0}}}),saveMfaTicket:D({mfa:(c,h)=>{var f;return(f=h.data)==null?void 0:f.mfa}}),resetTimer:D({refreshTimer:c=>({startedAt:new Date,attempts:0,lastAttempt:null})}),saveRefreshAttempt:D({refreshTimer:(c,h)=>({startedAt:c.refreshTimer.startedAt,attempts:c.refreshTimer.attempts+1,lastAttempt:new Date})}),saveAuthenticationError:D({errors:({errors:c},{data:{error:h}})=>({...c,authentication:h})}),resetErrors:D({errors:c=>({}),importTokenAttempts:c=>0}),saveRegistrationError:D({errors:({errors:c},{data:{error:h}})=>({...c,registration:h})}),destroyRefreshToken:D({refreshToken:c=>(u(ct,null),u(Pt,null),{value:null})}),destroyAccessToken:D({accessToken:c=>(u(He,null),{value:null,expiresAt:null,expiresInSeconds:null})}),cleanUrl:()=>{l&&jt("refreshToken")&&($t("refreshToken"),$t("type"))},broadcastToken:c=>{if(l&&r)try{new BroadcastChannel(r).postMessage({type:"broadcast_token",payload:{token:c.refreshToken.value}})}catch{}}},guards:{isAnonymous:(c,h)=>{var f;return!!((f=c.user)!=null&&f.isAnonymous)},isSignedIn:c=>!!c.user&&!!c.accessToken.value,noToken:c=>!c.refreshToken.value,isRefreshTokenPAT:c=>{var h;return!!((h=c.refreshToken)!=null&&h.isPAT)},hasRefreshToken:c=>!!c.refreshToken.value,isAutoRefreshDisabled:()=>!o,refreshTimerShouldRefresh:c=>{const{expiresAt:h}=c.accessToken;if(!h)return!1;if(c.refreshTimer.lastAttempt)return c.refreshTimer.attempts>An?!1:Date.now()-c.refreshTimer.lastAttempt.getTime()>Math.pow(2,c.refreshTimer.attempts-1)*5e3;if(h.getTime()<Date.now()||s&&Date.now()-c.refreshTimer.startedAt.getTime()>s*1e3)return!0;const f=c.accessToken.expiresInSeconds;return f?h.getTime()-Date.now()-1e3*Math.min(Ds,f*.5)<=0:!1},shouldRetryImportToken:(c,h)=>c.importTokenAttempts<An&&(h.data.error.status===In||h.data.error.status>=500),unverified:(c,{data:{error:h}})=>h.status===401&&(h.message==="Email is not verified"||h.error==="unverified-user"),hasSession:(c,h)=>{var f;return!!((f=h.data)!=null&&f.session)},hasMfaTicket:(c,h)=>{var f;return!!((f=h.data)!=null&&f.mfa)},isUnauthorizedError:(c,{data:{error:h}})=>h.status===401},services:{signInPassword:(c,{email:h,password:f})=>Se(h)?xr(f)?a("/signin/email-password",{email:h,password:f}):Promise.reject({error:Er}):Promise.reject({error:Te}),signInPAT:(c,{pat:h})=>a("/signin/pat",{personalAccessToken:h}),signInIdToken:(c,{provider:h,idToken:f,nonce:p})=>a("/signin/idtoken",{provider:h,idToken:f,...p&&{nonce:p}}),passwordlessSms:(c,{phoneNumber:h,options:f})=>{var p;return Fn(h)?(p=c.user)!=null&&p.isAnonymous?(console.warn("Deanonymisation from a phone number is not yet implemented in hasura-auth"),a("/user/deanonymize",{signInMethod:"passwordless",connection:"sms",phoneNumber:h,options:le(e,f)},c.accessToken.value)):a("/signin/passwordless/sms",{phoneNumber:h,options:le(e,f)}):Promise.reject({error:bn})},passwordlessSmsOtp:(c,{phoneNumber:h,otp:f})=>Fn(h)?a("/signin/passwordless/sms/otp",{phoneNumber:h,otp:f}):Promise.reject({error:bn}),signInEmailOTP:(c,{email:h,options:f})=>Se(h)?a("/signin/otp/email",{email:h,options:le(e,f)}):Promise.reject({error:Te}),verifyEmailOTP:(c,{email:h,otp:f})=>Se(h)?a("/signin/otp/email/verify",{email:h,otp:f}):Promise.reject({error:Te}),passwordlessEmail:(c,{email:h,options:f})=>{var p;return Se(h)?(p=c.user)!=null&&p.isAnonymous?a("/user/deanonymize",{signInMethod:"passwordless",connection:"email",email:h,options:le(e,f)},c.accessToken.value):a("/signin/passwordless/email",{email:h,options:le(e,f)}):Promise.reject({error:Te})},signInAnonymous:c=>a("/signin/anonymous"),signInMfaTotp:(c,h)=>{var f;const p=h.ticket||((f=c.mfa)==null?void 0:f.ticket);return p?to(p)?a("/signin/mfa/totp",{ticket:p,otp:h.otp}):Promise.reject({error:Us}):Promise.reject({error:Ls})},signInSecurityKeyEmail:async(c,{email:h})=>{if(!Se(h))throw new Re(Te);const f=await a("/signin/webauthn",{email:h});let p;try{p=await kr(f)}catch(m){throw new Re(m)}return a("/signin/webauthn/verify",{email:h,credential:p})},refreshToken:async(c,h)=>{const f=h.type==="TRY_TOKEN"?h.token:c.refreshToken.value;return{session:await a("/token",{refreshToken:f}),error:null}},signInSecurityKey:async()=>{try{const c=await a("/signin/webauthn",{});let h;try{h=await kr(c)}catch(f){throw new Re(f)}return a("/signin/webauthn/verify",{credential:h})}catch(c){throw new Re(c)}},signout:async(c,h)=>{const f=await a("/signout",{refreshToken:c.refreshToken.value,all:!!h.all},h.all?c.accessToken.value:void 0);if(r)try{new BroadcastChannel(r).postMessage({type:"signout"})}catch{}return f},signUpEmailPassword:async(c,{email:h,password:f,options:p,requestOptions:m})=>{var k;return Se(h)?xr(f)?(k=c.user)!=null&&k.isAnonymous?a("/user/deanonymize",{signInMethod:"email-password",email:h,password:f,options:le(e,p)},c.accessToken.value,m==null?void 0:m.headers):a("/signup/email-password",{email:h,password:f,options:le(e,p)},null,m==null?void 0:m.headers):Promise.reject({error:Er}):Promise.reject({error:Te})},signUpSecurityKey:async(c,{email:h,options:f})=>{if(!Se(h))return Promise.reject({error:Te});const p=f==null?void 0:f.nickname;p&&delete f.nickname;const m=await a("/signup/webauthn",{email:h,options:f});let k;try{k=await Cn(m)}catch(E){throw new Re(E)}return a("/signup/webauthn/verify",{credential:k,options:{redirectTo:f==null?void 0:f.redirectTo,nickname:p}})},importRefreshToken:async c=>{if(c.user&&c.refreshToken.value&&c.accessToken.value&&c.accessToken.expiresAt)return{session:{accessToken:c.accessToken.value,accessTokenExpiresIn:c.accessToken.expiresAt.getTime()-Date.now(),refreshToken:c.refreshToken.value,user:c.user},error:null};let h=null;if(l){const p=jt("refreshToken")||null;if(p)try{return{session:await a("/token",{refreshToken:p}),error:null}}catch(m){h=m.error}else{const m=jt("error"),k=jt("errorDescription");if(m&&k!=="social user already exists")return Promise.reject({session:null,error:{status:Ee,error:m,message:k||m}})}}const f=await d(ct);if(f)try{return{session:await a("/token",{refreshToken:f}),error:null}}catch(p){h=p.error}return h?Promise.reject({error:h,session:null}):{error:null,session:null}}},delays:{RETRY_IMPORT_TOKEN_DELAY:({importTokenAttempts:c})=>Math.pow(2,c-1)*5e3}})},jn=({backendUrl:t,clientUrl:e,interpreter:r})=>Oe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changeEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:D({error:n=>Te}),saveRequestError:D({error:(n,{data:{error:i}})=>i}),reportError:se(n=>({type:"ERROR",error:n.error})),reportSuccess:se("SUCCESS")},guards:{invalidEmail:(n,{email:i})=>!Se(i)},services:{requestChange:async(n,{email:i,options:s})=>(await fe(`${t}/user/email/change`,{newEmail:i,options:le(e,s)},r==null?void 0:r.getSnapshot().context.accessToken.value)).data}}),$n=({backendUrl:t,interpreter:e})=>Oe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidPassword",actions:"saveInvalidPasswordError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidPasswordError:D({error:r=>Er}),saveRequestError:D({error:(r,{data:{error:n}})=>n}),reportError:se(r=>({type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS")},guards:{invalidPassword:(r,{password:n})=>!xr(n)},services:{requestChange:(r,{password:n,ticket:i})=>fe(`${t}/user/password`,{newPassword:n,ticket:i},e==null?void 0:e.getSnapshot().context.accessToken.value)}}),no=({backendUrl:t,interpreter:e})=>Oe({schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,id:"enableMfa",initial:"idle",context:{error:null,imageUrl:null,secret:null},states:{idle:{initial:"initial",on:{GENERATE:"generating"},states:{initial:{},error:{}}},generating:{invoke:{src:"generate",id:"generate",onDone:{target:"generated",actions:["reportGeneratedSuccess","saveGeneration"]},onError:{actions:["saveError","reportGeneratedError"],target:"idle.error"}}},generated:{initial:"idle",states:{idle:{initial:"idle",on:{ACTIVATE:[{cond:"invalidMfaType",actions:"saveInvalidMfaTypeError",target:".error"},{cond:"invalidMfaCode",actions:"saveInvalidMfaCodeError",target:".error"},{target:"activating"}]},states:{idle:{},error:{}}},activating:{invoke:{src:"activate",id:"activate",onDone:{target:"activated",actions:"reportSuccess"},onError:{actions:["saveError","reportError"],target:"idle.error"}}},activated:{type:"final"}}}}},{actions:{saveInvalidMfaTypeError:D({error:r=>Ps}),saveInvalidMfaCodeError:D({error:r=>Cs}),saveError:D({error:(r,{data:{error:n}})=>n}),saveGeneration:D({imageUrl:(r,{data:{imageUrl:n}})=>n,secret:(r,{data:{totpSecret:n}})=>n}),reportError:se((r,n)=>(console.log("REPORT",r,n),{type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS"),reportGeneratedSuccess:se("GENERATED"),reportGeneratedError:se(r=>({type:"GENERATED_ERROR",error:r.error}))},guards:{invalidMfaCode:(r,{code:n})=>!n,invalidMfaType:(r,{activeMfaType:n})=>!n||n!=="totp"},services:{generate:async r=>{const{data:n}=await eo(`${t}/mfa/totp/generate`,e==null?void 0:e.getSnapshot().context.accessToken.value);return n},activate:(r,{code:n,activeMfaType:i})=>fe(`${t}/user/mfa`,{code:n,activeMfaType:i},e==null?void 0:e.getSnapshot().context.accessToken.value)}}),Vn=({backendUrl:t,clientUrl:e})=>Oe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:D({error:r=>Te}),saveRequestError:D({error:(r,{data:{error:n}})=>n}),reportError:se(r=>({type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS")},guards:{invalidEmail:(r,{email:n})=>!Se(n)},services:{requestChange:(r,{email:n,options:i})=>fe(`${t}/user/password/reset`,{email:n,options:le(e,i)})}}),Bn=({backendUrl:t,clientUrl:e})=>Oe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"sendVerificationEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"request",id:"request",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:D({error:r=>Te}),saveRequestError:D({error:(r,{data:{error:n}})=>n}),reportError:se(r=>({type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS")},guards:{invalidEmail:(r,{email:n})=>!Se(n)},services:{request:async(r,{email:n,options:i})=>(await fe(`${t}/user/email/send-verification-email`,{email:n,options:le(e,i)})).data}});class io{constructor({clientStorageType:e="web",autoSignIn:r=!0,autoRefreshToken:n=!0,start:i=!0,backendUrl:s,clientUrl:o,broadcastKey:l,devTools:d,...u}){var a;if(this._started=!1,this._subscriptionsQueue=new Set,this._subscriptions=new Set,this.backendUrl=s,this.clientUrl=o,this._machine=ro({...u,backendUrl:s,clientUrl:o,broadcastKey:l,clientStorageType:e,autoSignIn:r,autoRefreshToken:n}),i&&this.start({devTools:d}),typeof window!="undefined"&&l)try{this._channel=new BroadcastChannel(l),r&&((a=this._channel)==null||a.addEventListener("message",c=>{var h;const{type:f,payload:p}=c.data;if(f==="broadcast_token"){const m=(h=this.interpreter)==null?void 0:h.getSnapshot().context.refreshToken.value;this.interpreter&&p.token&&p.token!==m&&this.interpreter.send("TRY_TOKEN",{token:p.token})}})),this._channel.addEventListener("message",c=>{const{type:h}=c.data;h==="signout"&&this.interpreter&&this.interpreter.send("SIGNOUT")})}catch{}}start({devTools:e=!1,initialSession:r,interpreter:n}={}){var i,s;const o={...this.machine.context,accessToken:{...this.machine.context.accessToken},refreshToken:{...this.machine.context.refreshToken}};r&&(o.user=r.user,o.refreshToken.value=(i=r.refreshToken)!=null?i:null,o.accessToken.value=(s=r.accessToken)!=null?s:null,o.accessToken.expiresAt=new Date(Date.now()+r.accessTokenExpiresIn*1e3));const l=this.machine.withContext(o);this._interpreter||(this._interpreter=n||_e(l,{devTools:e})),(!this._started||typeof window=="undefined")&&(this._interpreter.initialized&&(this._interpreter.stop(),this._subscriptions.forEach(d=>d())),this._interpreter.start(l.initialState),this._subscriptionsQueue.forEach(d=>d(this))),this._started=!0}get machine(){return this._machine}get interpreter(){return this._interpreter}get started(){return this._started}subscribe(e){if(this.started){const r=e(this);return this._subscriptions.add(r),r}else return this._subscriptionsQueue.add(e),()=>{console.log("onTokenChanged was added before the interpreter started. Cannot unsubscribe listener.")}}}const Gn=async({backendUrl:t,interpreter:e},r)=>{try{const{data:n}=await fe(`${t}/user/webauthn/add`,{},e==null?void 0:e.getSnapshot().context.accessToken.value);let i;try{i=await Cn(n)}catch(o){throw new Re(o)}const{data:s}=await fe(`${t}/user/webauthn/verify`,{credential:i,nickname:r},e==null?void 0:e.getSnapshot().context.accessToken.value);return{key:s,isError:!1,error:null,isSuccess:!0}}catch(n){const{error:i}=n;return{isError:!0,error:i,isSuccess:!1}}},qn=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,needsEmailVerification:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,needsEmailVerification:!0})})}),Hn=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{password:e,ticket:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSuccess:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSuccess:!0})})}),so=t=>new Promise(e=>{t.send("GENERATE"),t.onTransition(r=>{r.matches("generated")?e({error:null,isError:!1,isGenerated:!0,qrCodeDataUrl:r.context.imageUrl||""}):r.matches({idle:"error"})&&e({error:r.context.error||null,isError:!0,isGenerated:!1,qrCodeDataUrl:""})})}),oo=(t,e)=>new Promise(r=>{t.send("ACTIVATE",{activeMfaType:"totp",code:e}),t.onTransition(n=>{n.matches({generated:"activated"})?r({error:null,isActivated:!0,isError:!1}):n.matches({generated:{idle:"error"}})&&r({error:n.context.error,isActivated:!1,isError:!0})})}),Kn=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),Yn=(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),zn=t=>new Promise(e=>{const{changed:r}=t.send("SIGNIN_ANONYMOUS");r||e({isSuccess:!1,isError:!0,error:ue,user:null,accessToken:null,refreshToken:null}),t.onTransition(n=>{n.matches({authentication:"signedIn"})&&e({isSuccess:!0,isError:!1,error:null,user:n.context.user,accessToken:n.context.accessToken.value,refreshToken:n.context.refreshToken.value}),n.matches({authentication:{signedOut:"failed"}})&&e({isSuccess:!1,isError:!0,error:n.context.errors.authentication||null,user:null,accessToken:null,refreshToken:null})})}),Jn=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_PASSWORD",{email:e,password:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:ue,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:{signedOut:"needsMfa"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!0,mfa:o.context.mfa,user:null}):o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:o.context.user})})}),Ar=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_EMAIL",{email:e,options:r});if(!i)return n({error:ue,isError:!0,isSuccess:!1});t.onTransition(s=>{s.matches("registration.incomplete.failed")?n({error:s.context.errors.registration||null,isError:!0,isSuccess:!1}):s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})&&n({error:null,isError:!1,isSuccess:!0})})}),Wn=(t,e)=>new Promise(r=>{const{changed:n,context:i}=t.send({type:"SIGNIN_SECURITY_KEY_EMAIL",email:e});if(!n)return r({accessToken:i.accessToken.value,refreshToken:i.refreshToken.value,error:ue,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:i.user});t.onTransition(s=>{s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?r({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):s.matches({authentication:{signedOut:"failed"}})?r({accessToken:null,refreshToken:null,error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):s.matches({authentication:"signedIn"})&&r({accessToken:s.context.accessToken.value,refreshToken:s.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:s.context.user})})}),Qn=(t,e)=>new Promise(async r=>{var n,i;const s=(n=t.interpreter)==null?void 0:n.getSnapshot(),o=s==null?void 0:s.context.accessToken.value,{data:l}=await fe(`${t.backendUrl}/elevate/webauthn`,{email:e},o);let d;try{d=await kr(l)}catch(u){throw new Re(u)}try{const{data:{session:u},error:a}=await fe(`${t.backendUrl}/elevate/webauthn/verify`,{email:e,credential:d},o);u&&!a&&((i=t.interpreter)==null||i.send({type:"SESSION_UPDATE",data:{session:u}}),r({error:null,isError:!1,isSuccess:!0,elevated:!0}))}catch(u){const{error:a}=u;r({error:a,isError:!0,isSuccess:!1,elevated:!1})}}),Xn=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_MFA_TOTP",{otp:e,ticket:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:ue,isError:!0,isSuccess:!1,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,user:o.context.user})})}),Zn=(t,e)=>new Promise(r=>{const{changed:n}=t.send("SIGNIN_PAT",{pat:e});n||r({isSuccess:!1,isError:!0,error:ue,user:null,accessToken:null,refreshToken:null}),t.onTransition(i=>{if(i.matches({authentication:{signedOut:"failed"}}))return r({accessToken:null,refreshToken:null,user:null,error:i.context.errors.authentication||null,isError:!0,isSuccess:!1});if(i.matches({authentication:"signedIn"}))return r({accessToken:i.context.accessToken.value,refreshToken:i.context.refreshToken.value,user:i.context.user,error:null,isError:!1,isSuccess:!0})})}),Ir=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_SMS",{phoneNumber:e,options:r});if(!i)return n({error:ue,isError:!0,isSuccess:!1,needsOtp:!1});t.onTransition(s=>{s.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!1,needsOtp:!0}):s.matches("registration.incomplete.failed")&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),Or=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send({type:"PASSWORDLESS_SMS_OTP",phoneNumber:e,otp:r});if(!i)return n({error:ue,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});t.onTransition(s=>{s.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:s.context.user,accessToken:s.context.accessToken.value,refreshToken:s.context.refreshToken.value}):s.matches({registration:{incomplete:"failed"}})&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),ei=async(t,e)=>new Promise(r=>{const{event:n}=t.send("SIGNOUT",{all:e});if(n.type!=="SIGNED_OUT")return r({isSuccess:!1,isError:!0,error:js});t.onTransition(i=>{i.matches({authentication:{signedOut:"success"}})?r({isSuccess:!0,isError:!1,error:null}):i.matches("authentication.signedOut.failed")&&r({isSuccess:!1,isError:!0,error:i.context.errors.signout||null})})}),br=(t,e,r,n,i)=>new Promise(s=>{const{changed:o,context:l}=t.send("SIGNUP_EMAIL_PASSWORD",{email:e,password:r,options:n,requestOptions:i});if(!o)return s({error:ue,accessToken:l.accessToken.value,refreshToken:l.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:l.user});t.onTransition(d=>{d.matches("registration.incomplete.failed")?s({accessToken:null,refreshToken:null,error:d.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):d.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?s({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):d.matches({authentication:"signedIn",registration:"complete"})&&s({accessToken:d.context.accessToken.value,refreshToken:d.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:d.context.user})})}),ti=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNUP_SECURITY_KEY",{email:e,options:r});if(!i)return n({error:ue,accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:s.user});t.onTransition(o=>{o.matches("registration.incomplete.failed")?n({accessToken:null,refreshToken:null,error:o.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):o.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):o.matches({authentication:"signedIn",registration:"complete"})&&n({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:o.context.user})})}),ri=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("SIGNIN_EMAIL_OTP",{email:e,options:r});if(!i)return n({error:ue,isError:!0,isSuccess:!1,needsOtp:!1});t.onTransition(s=>{s.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!0,needsOtp:!0}):s.matches("registration.incomplete.failed")&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),ni=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send({type:"VERIFY_EMAIL_OTP",email:e,otp:r});if(!i)return n({error:ue,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});t.onTransition(s=>{s.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:s.context.user,accessToken:s.context.accessToken.value,refreshToken:s.context.refreshToken.value}):s.matches({registration:{incomplete:"failed"}})&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),ii=(t,{provider:e,idToken:r,nonce:n})=>new Promise(i=>{const{changed:s}=t.send("SIGNIN_ID_TOKEN",{provider:e,idToken:r,...n&&{nonce:n}});s||i({isSuccess:!1,isError:!0,error:ue,user:null,accessToken:null,refreshToken:null}),t.onTransition(o=>{if(o.matches({authentication:{signedOut:"failed"}}))return i({accessToken:null,refreshToken:null,user:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1});if(o.matches({authentication:"signedIn"}))return i({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,user:o.context.user,error:null,isError:!1,isSuccess:!0})})}),si=async({backendUrl:t,interpreter:e},{provider:r,idToken:n,nonce:i})=>{try{return await fe(`${t}/link/idtoken`,{provider:r,idToken:n,...i&&{nonce:i}},e==null?void 0:e.getSnapshot().context.accessToken.value),{isError:!1,error:null,isSuccess:!0}}catch(s){const{error:o}=s;return{isError:!0,error:o,isSuccess:!1}}},oi=t=>new Promise(e=>{const{changed:r,context:n}=t.send({type:"SIGNIN_SECURITY_KEY"});if(!r)return e({accessToken:n.accessToken.value,refreshToken:n.refreshToken.value,error:ue,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:n.user});t.onTransition(i=>{i.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?e({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):i.matches({authentication:{signedOut:"failed"}})?e({accessToken:null,refreshToken:null,error:i.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):i.matches({authentication:"signedIn"})&&e({accessToken:i.context.accessToken.value,refreshToken:i.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:i.context.user})})}),ao=async({backendUrl:t,interpreter:e},{expiresAt:r,metadata:n})=>{try{const{data:i}=await fe(`${t}/pat`,{expiresAt:r.toISOString(),metadata:n},e==null?void 0:e.getSnapshot().context.accessToken.value);return{data:i?{id:i.id||null,personalAccessToken:i.personalAccessToken||null}:null,isError:!1,error:null,isSuccess:!0}}catch(i){const{error:s}=i;return{isError:!0,error:s,isSuccess:!1,data:null}}};class co{constructor({url:e,broadcastKey:r,autoRefreshToken:n=!0,autoSignIn:i=!0,clientStorage:s,clientStorageType:o,refreshIntervalTime:l,start:d=!0}){var u;this.url=e,this._client=new io({backendUrl:e,clientUrl:typeof window!="undefined"&&((u=window.location)==null?void 0:u.origin)||"",broadcastKey:r,autoRefreshToken:n,autoSignIn:i,start:d,clientStorage:s,clientStorageType:o,refreshIntervalTime:l})}async signUp(e){const r=await this.waitUntilReady(),{email:n,options:i}=e;return"securityKey"in e?me(await ti(r,n,i)):me(await br(r,n,e.password,i))}async connectProvider(e){const r=(await this.waitUntilReady()).getSnapshot().context.accessToken.value,{provider:n,options:i}=e,s=Ft(`${this._client.backendUrl}/signin/provider/${n}`,le(this._client.clientUrl,{...i,connect:r}));return Un()&&(window.location.href=s),{providerUrl:s}}async signInIdToken(e){const r=await this.waitUntilReady(),n=await ii(r,e);return{...me(n),mfa:null}}async linkIdToken(e){return si(this._client,e)}async signIn(e){const r=await this.waitUntilReady();if(!e){const n=await zn(r);return{...me(n),mfa:null}}if("provider"in e){const{provider:n,options:i}=e,s=Ft(`${this._client.backendUrl}/signin/provider/${n}`,le(this._client.clientUrl,i));return Un()&&(window.location.href=s),{providerUrl:s,provider:n,session:null,mfa:null,error:null}}if("email"in e&&"password"in e){const n=await Jn(r,e.email,e.password);return n.needsEmailVerification?{session:null,mfa:null,error:$s}:n.needsMfaOtp?{session:null,mfa:n.mfa,error:null}:{...me(n),mfa:null}}if("email"in e&&"securityKey"in e){if(e.securityKey!==!0)throw Error("securityKey must be true");const n=await Wn(r,e.email);return{...me(n),mfa:null}}if("email"in e){const{email:n,options:i}=e,{error:s}=await Ar(r,n,i);return{session:null,mfa:null,error:s}}if("phoneNumber"in e&&"otp"in e){const n=await Or(r,e.phoneNumber,e.otp);return{...me(n),mfa:null}}if("phoneNumber"in e){const{error:n}=await Ir(r,e.phoneNumber,e.options);return{error:n,mfa:null,session:null}}if("otp"in e){const n=await Xn(r,e.otp,e.ticket);return{...me(n),mfa:null}}return{error:Bs,mfa:null,session:null}}async signInPAT(e){const r=await this.waitUntilReady(),n=await Zn(r,e);return me(n)}async signInEmailOTP(e,r){const n=await this.waitUntilReady(),{error:i}=await ri(n,e,r);return{error:i,session:null,mfa:null}}async verifyEmailOTP(e,r){const n=await this.waitUntilReady(),i=await ni(n,e,r);return{...me(i),mfa:null}}async signInSecurityKey(){const e=await this.waitUntilReady(),r=await oi(e);return{...me(r),mfa:null}}async signOut(e){const r=await this.waitUntilReady(),{error:n}=await ei(r,e==null?void 0:e.all);return{error:n}}async resetPassword({email:e,options:r}){const n=_e(Vn(this._client)).start(),{error:i}=await Kn(n,e,r);return{error:i}}async changePassword({newPassword:e,ticket:r}){const n=_e($n(this._client)).start(),{error:i}=await Hn(n,e,r);return{error:i}}async sendVerificationEmail({email:e,options:r}){const n=_e(Bn(this._client)).start(),{error:i}=await Yn(n,e,r);return{error:i}}async changeEmail({newEmail:e,options:r}){const n=_e(jn(this._client)).start(),{error:i}=await qn(n,e,r);return{error:i}}async deanonymize(e){const r=await this.waitUntilReady();if(e.signInMethod==="passwordless"){if(e.connection==="email"){const{error:n}=await Ar(r,e.email,e.options);return{error:n}}if(e.connection==="sms"){const{error:n}=await Ir(r,e.phoneNumber,e.options);return{error:n}}}if(e.signInMethod==="email-password"){const{error:n}=await br(r,e.email,e.password,e.options);return{error:n}}throw Error("Unknown deanonymization method")}async addSecurityKey(e){const{error:r,key:n}=await Gn(this._client,e);return{error:r,key:n}}async elevateEmailSecurityKey(e){if(!e)throw Error("A user email is required");return{...await Qn(this._client,e),mfa:null}}async createPAT(e,r){return ao(this._client,{expiresAt:e,metadata:r})}onTokenChanged(e){return this._client.subscribe(()=>{var r;const n=(r=this._client.interpreter)==null?void 0:r.onTransition(({event:i,context:s})=>{i.type==="TOKEN_CHANGED"&&e(Mt(s))});return()=>n==null?void 0:n.stop()})}onAuthStateChanged(e){return this._client.subscribe(()=>{var r;const n=(r=this._client.interpreter)==null?void 0:r.onTransition(({event:i,context:s})=>{(i.type==="SIGNED_IN"||i.type==="SIGNED_OUT")&&e(i.type,Mt(s))});return()=>n==null?void 0:n.stop()})}isAuthenticated(){var e;return!!((e=this._client.interpreter)!=null&&e.getSnapshot().matches({authentication:"signedIn"}))}async isAuthenticatedAsync(){return(await this.waitUntilReady()).getSnapshot().matches({authentication:"signedIn"})}getAuthenticationStatus(){var e;const r=((e=this.client.interpreter)==null?void 0:e.getSnapshot().context.importTokenAttempts)||0;return this.isReady()?{isAuthenticated:this.isAuthenticated(),isLoading:!1,connectionAttempts:r}:{isAuthenticated:!1,isLoading:!0,connectionAttempts:r}}getAccessToken(){var e,r;return(r=(e=this._client.interpreter)==null?void 0:e.getSnapshot().context.accessToken.value)!=null?r:void 0}getDecodedAccessToken(){const e=this.getAccessToken();return e?Qt(e):null}getHasuraClaims(){var e;return((e=this.getDecodedAccessToken())==null?void 0:e["https://hasura.io/jwt/claims"])||null}getHasuraClaim(e){var r;return((r=this.getHasuraClaims())==null?void 0:r[e.startsWith("x-hasura-")?e:`x-hasura-${e}`])||null}async refreshSession(e){try{const r=await this.waitUntilReady();return new Promise(n=>{const i=e||r.getSnapshot().context.refreshToken.value;if(!i)return n({session:null,error:Ms});const{changed:s}=r.send("TRY_TOKEN",{token:i});if(!s)return n({session:null,error:Fs});r.onTransition(o=>{o.matches({token:{idle:"error"}})?n({session:null,error:Vs}):o.event.type==="TOKEN_CHANGED"&&n({session:Mt(o.context),error:null})})})}catch(r){return{session:null,error:r.message}}}getSession(){var e,r;return Mt((r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())==null?void 0:r.context)}async initWithSession({session:e}){this.client.start({initialSession:e}),await this.waitUntilReady()}getUser(){var e,r,n;return((n=(r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())==null?void 0:r.context)==null?void 0:n.user)||null}waitUntilReady(){const e=this._client.interpreter;if(!e)throw Error("Auth interpreter not set");return e.getSnapshot().hasTag("loading")?new Promise((r,n)=>{let i=setTimeout(()=>n("The state machine is not yet ready after 15 seconds."),15e3);e.onTransition(s=>{if(!s.hasTag("loading"))return clearTimeout(i),r(e)})}):Promise.resolve(e)}isReady(){var e,r;return!((r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())!=null&&r.hasTag("loading"))}get client(){return this._client}}var uo=typeof self=="object"?self.FormData:window.FormData;const Nr=mr(uo);let ai=globalThis.fetch;const _r=async(t,e,{accessToken:r,name:n,fileId:i,bucketId:s,adminSecret:o,onUploadProgress:l,headers:d={}}={})=>{var u;const a={...d};s&&e.append("bucket-id",s),o&&(a["x-hasura-admin-secret"]=o),r&&(a.Authorization=`Bearer ${r}`);const c=`${t}/files`;if(typeof XMLHttpRequest=="undefined")try{e instanceof Nr&&(ai=yr().fetch);const h=await ai(c,{method:"POST",headers:a,body:e}),f=await h.json();return h.ok?{fileMetadata:f,error:null}:{error:{status:h.status,message:((u=f==null?void 0:f.error)==null?void 0:u.message)||h.statusText,error:h.statusText},fileMetadata:null}}catch(h){return{error:{status:0,message:h.message,error:h.message},fileMetadata:null}}return new Promise(h=>{let f=new XMLHttpRequest;f.responseType="json",f.onload=()=>{var p,m,k,E,w,x,O,F;if(f.status<200||f.status>=300){const U={error:(w=(E=(m=(p=f.response)==null?void 0:p.error)==null?void 0:m.message)!=null?E:(k=f.response)==null?void 0:k.error)!=null?w:f.response,message:(F=(O=(x=f.response)==null?void 0:x.error)==null?void 0:O.message)!=null?F:f.response,status:f.status};return h({fileMetadata:null,error:U})}return h({fileMetadata:f.response,error:null})},f.onerror=()=>{const p={error:f.statusText,message:f.statusText,status:f.status};return h({fileMetadata:null,error:p})},l&&f.upload.addEventListener("progress",l,!1),f.open("POST",c,!0),Object.entries(a).forEach(([p,m])=>{f.setRequestHeader(p,m)}),f.send(e)})};function Rr(t,e){if(!e||Object.keys(e).length===0)return t;const r=new URL(t),n=Object.entries(e).reduce((i,[s,o])=>({...i,[s.charAt(0)]:o}),{});return Object.entries(n).forEach(([i,s])=>{s&&r.searchParams.set(i,s)}),r.toString()}let ut;typeof ut=="undefined"&&(ut=yr().fetch);let lo=class{constructor({url:e}){this.headers={},this.url=e}async uploadFormData({formData:e,bucketId:r,headers:n}){const{error:i,fileMetadata:s}=await _r(this.url,e,{bucketId:r,headers:{...this.headers,...n},accessToken:this.accessToken,adminSecret:this.adminSecret});return i?{fileMetadata:null,error:i}:s&&!("processedFiles"in s)?{fileMetadata:{processedFiles:[s]},error:null}:{fileMetadata:s,error:null}}async uploadFile({file:e,bucketId:r,id:n,name:i,headers:s}){const o=typeof window=="undefined"?new Nr:new FormData;o.append("file[]",e),o.append("metadata[]",JSON.stringify({id:n,name:i}));const{error:l,fileMetadata:d}=await _r(this.url,o,{accessToken:this.accessToken,adminSecret:this.adminSecret,bucketId:r,fileId:n,name:i,headers:{...this.headers,...s}});return l?{fileMetadata:null,error:l}:d&&"processedFiles"in d?{fileMetadata:d.processedFiles[0],error:null}:{fileMetadata:d,error:null}}async downloadFile(e){try{const{fileId:r,headers:n,...i}=e,s=Rr(`${this.url}/files/${r}`,i),o=await ut(s,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...n}});if(!o.ok)throw new Error(await o.text());return{file:await o.blob(),error:null}}catch(r){return{file:null,error:r}}}async getPresignedUrl(e){try{const{fileId:r,headers:n}=e,i=await ut(`${this.url}/files/${r}/presignedurl`,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...n}});if(!i.ok)throw new Error(await i.text());return{presignedUrl:await i.json(),error:null}}catch(r){return{presignedUrl:null,error:r}}}async delete(e){try{const{fileId:r,headers:n}=e,i=await ut(`${this.url}/files/${r}`,{method:"DELETE",headers:{...this.generateAuthHeaders(),...this.headers,...n}});if(!i.ok)throw new Error(await i.text());return{error:null}}catch(r){return{error:r}}}setAccessToken(e){return this.accessToken=e,this}setAdminSecret(e){return this.adminSecret=e,this}getHeaders(){return this.headers}setHeaders(e){return e?(this.headers={...this.headers,...e},this):this}unsetHeaders(){const e=this.headers["x-hasura-role"];return this.headers=e?{"x-hasura-role":e}:{},this}generateAuthHeaders(){if(!(!this.adminSecret&&!this.accessToken))return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:{Authorization:`Bearer ${this.accessToken}`}}};class ho{constructor({url:e,adminSecret:r}){this.url=e,this.api=new lo({url:e}),this.setAdminSecret(r)}async upload(e){return"file"in e?this.api.uploadFile(e):this.api.uploadFormData(e)}getPublicUrl(e){const{fileId:r,...n}=e;return Rr(`${this.url}/files/${r}`,n)}async getPresignedUrl(e){const{fileId:r,headers:n,...i}=e,{presignedUrl:s,error:o}=await this.api.getPresignedUrl(e);if(o)return{presignedUrl:null,error:o};if(!s)return{presignedUrl:null,error:new Error("Invalid file id")};const l=Rr(s.url,i);return{presignedUrl:{...s,url:l},error:null}}async download(e){const{file:r,error:n}=await this.api.downloadFile(e);return n?{file:null,error:n}:r?{file:r,error:null}:{file:null,error:new Error("File does not exist")}}async delete(e){const{error:r}=await this.api.delete(e);return r?{error:r}:{error:null}}setAccessToken(e){return this.api.setAccessToken(e),this}setAdminSecret(e){return this.api.setAdminSecret(e),this}getHeaders(){return this.api.getHeaders()}setHeaders(e){return this.api.setHeaders(e),this}unsetHeaders(){return this.api.unsetHeaders(),this}}let Dr;typeof Dr=="undefined"&&(Dr=Nr);const Pr={progress:null,loaded:0,error:null,bucketId:void 0,file:void 0,id:void 0},ci=()=>Oe({predictableActionArguments:!0,schema:{context:{},events:{}},tsTypes:{},context:{...Pr},initial:"idle",on:{DESTROY:{actions:"sendDestroy",target:"stopped"}},states:{idle:{on:{ADD:{actions:"addFile"},UPLOAD:{cond:"hasFile",target:"uploading"}}},uploading:{entry:"resetProgress",on:{UPLOAD_PROGRESS:{actions:["incrementProgress","sendProgress"]},UPLOAD_DONE:"uploaded",UPLOAD_ERROR:"error",CANCEL:"idle"},invoke:{src:"uploadFile"}},uploaded:{entry:["setFileMetadata","sendDone"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},error:{entry:["setError","sendError"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},stopped:{type:"final"}}},{guards:{hasFile:(t,e)=>!!t.file||!!e.file},actions:{incrementProgress:D({loaded:(t,{loaded:e})=>e,progress:(t,{progress:e})=>e}),setFileMetadata:D({id:(t,{id:e})=>e,bucketId:(t,{bucketId:e})=>e,progress:t=>100}),setError:D({error:(t,{error:e})=>e}),sendProgress:()=>{},sendError:()=>{},sendDestroy:()=>{},sendDone:()=>{},resetProgress:D({progress:t=>null,loaded:t=>0}),resetContext:D(t=>Pr),addFile:D({file:(t,{file:e})=>e,bucketId:(t,{bucketId:e})=>e,id:(t,{id:e})=>e})},services:{uploadFile:(t,e)=>r=>{const n=e.file||t.file,i=new Dr;i.append("file[]",n);let s=0;return _r(e.url,i,{fileId:e.id||t.id,bucketId:e.bucketId||t.bucketId,accessToken:e.accessToken,adminSecret:e.adminSecret,name:e.name||n.name,onUploadProgress:o=>{const l=o.total?Math.round(o.loaded*n.size/o.total):0,d=l-s;s=l,r({type:"UPLOAD_PROGRESS",progress:o.total?Math.round(l*100/o.total):0,loaded:l,additions:d})}}).then(({fileMetadata:o,error:l})=>{if(l&&r({type:"UPLOAD_ERROR",error:l}),o&&!("processedFiles"in o)){const{id:d,bucketId:u}=o;r({type:"UPLOAD_DONE",id:d,bucketId:u})}if(o&&"processedFiles"in o){const{id:d,bucketId:u}=o.processedFiles[0];r({type:"UPLOAD_DONE",id:d,bucketId:u})}}),()=>{}}}}),{pure:Cr,sendParent:Vt}=ss,fo=()=>Oe({id:"files-list",schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,context:{progress:null,files:[],loaded:0,total:0},initial:"idle",on:{UPLOAD:{cond:"hasFileToDownload",actions:"addItem",target:"uploading"},ADD:{actions:"addItem"},REMOVE:{actions:"removeItem"}},states:{idle:{entry:["resetProgress","resetLoaded","resetTotal"],on:{CLEAR:{actions:"clearList",target:"idle"}}},uploading:{entry:["upload","startProgress","resetLoaded","resetTotal"],on:{UPLOAD_PROGRESS:{actions:["incrementProgress"]},UPLOAD_DONE:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],UPLOAD_ERROR:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],CANCEL:{actions:"cancel",target:"idle"}}},uploaded:{entry:"setUploaded",on:{CLEAR:{actions:"clearList",target:"idle"}}},error:{on:{CLEAR:{actions:"clearList",target:"idle"}}}}},{guards:{hasFileToDownload:(t,e)=>t.files.some(r=>r.getSnapshot().matches("idle"))||!!e.files,isAllUploaded:t=>t.files.every(e=>{var r;return(r=e.getSnapshot())==null?void 0:r.matches("uploaded")}),isAllUploadedOrError:t=>t.files.every(e=>{const r=e.getSnapshot();return(r==null?void 0:r.matches("error"))||(r==null?void 0:r.matches("uploaded"))})},actions:{incrementProgress:D((t,e)=>{const r=t.loaded+e.additions,n=Math.round(r*100/t.total);return{...t,loaded:r,progress:n}}),setUploaded:D({progress:t=>100,loaded:({files:t})=>t.map(e=>e.getSnapshot()).filter(e=>e.matches("uploaded")).reduce((e,r)=>{var n;return e+((n=r.context.file)==null?void 0:n.size)},0)}),resetTotal:D({total:({files:t})=>t.map(e=>e.getSnapshot()).filter(e=>!e.matches("uploaded")).reduce((e,r)=>{var n;return e+((n=r.context.file)==null?void 0:n.size)},0)}),resetLoaded:D({loaded:t=>0}),startProgress:D({progress:t=>0}),resetProgress:D({progress:t=>null}),addItem:D((t,{files:e,bucketId:r})=>{const n=e?Array.isArray(e)?e:"item"in e?Array.from(e):[e]:[],i=t.total+n.reduce((o,l)=>o+l.size,0),s=Math.round(t.loaded*100/i);return{files:[...t.files,...n.map(o=>ks(ci().withConfig({actions:{sendProgress:Vt((l,{additions:d})=>({type:"UPLOAD_PROGRESS",additions:d})),sendDone:Vt("UPLOAD_DONE"),sendError:Vt("UPLOAD_ERROR"),sendDestroy:Vt("REMOVE")}}).withContext({...Pr,file:o,bucketId:r}),{sync:!0}))],total:i,loaded:t.loaded,progress:s}}),removeItem:D({files:t=>t.files.filter(e=>{var r,n;const i=(r=e.getSnapshot())==null?void 0:r.matches("stopped");return i&&((n=e.stop)==null||n.call(e)),!i})}),clearList:Cr(t=>t.files.map(e=>se({type:"DESTROY"},{to:e.id}))),upload:Cr((t,e)=>t.files.map(r=>se(e,{to:r.id}))),cancel:Cr(t=>t.files.map(e=>se({type:"CANCEL"},{to:e.id})))}}),po=async(t,e)=>new Promise(r=>{e.send({type:"UPLOAD",...t}),e.subscribe(n=>{var i;n.matches("error")?r({error:n.context.error,isError:!0,isUploaded:!1}):n.matches("uploaded")&&r({error:null,isError:!1,isUploaded:!0,id:n.context.id,bucketId:n.context.id,name:(i=n.context.file)==null?void 0:i.name})})}),vo=async(t,e)=>new Promise(r=>{e.send({type:"UPLOAD",...t,files:t.files}),e.onTransition(n=>{n.matches("error")?r({errors:n.context.files.filter(i=>{var s;return(s=i.getSnapshot())==null?void 0:s.context.error}),isError:!0,files:[]}):n.matches("uploaded")&&r({errors:[],isError:!1,files:n.context.files})})});function mo(t,e){return e=e||{},new Promise(function(r,n){var i=new XMLHttpRequest,s=[],o=[],l={},d=function(){return{ok:(i.status/100|0)==2,statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:d,headers:{keys:function(){return s},entries:function(){return o},get:function(a){return l[a.toLowerCase()]},has:function(a){return a.toLowerCase()in l}}}};for(var u in i.open(e.method||"get",t,!0),i.onload=function(){i.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(a,c,h){s.push(c=c.toLowerCase()),o.push([c,h]),l[c]=l[c]?l[c]+","+h:h}),r(d())},i.onerror=n,i.withCredentials=e.credentials=="include",e.headers)i.setRequestHeader(u,e.headers[u]);i.send(e.body||null)})}const ui=Ns(Object.freeze(Object.defineProperty({__proto__:null,default:mo},Symbol.toStringTag,{value:"Module"})));var go=self.fetch||(self.fetch=ui.default||ui);const li=mr(go);function Bt(t,e){if(!!!t)throw new Error(e)}function yo(t){return typeof t=="object"&&t!==null}function Eo(t,e){if(!!!t)throw new Error("Unexpected invariant triggered.")}const To=/\r\n|[\n\r]/g;function Ur(t,e){let r=0,n=1;for(const i of t.body.matchAll(To)){if(typeof i.index=="number"||Eo(!1),i.index>=e)break;r=i.index+i[0].length,n+=1}return{line:n,column:e+1-r}}function So(t){return di(t.source,Ur(t.source,t.start))}function di(t,e){const r=t.locationOffset.column-1,n="".padStart(r)+t.body,i=e.line-1,s=t.locationOffset.line-1,o=e.line+s,l=e.line===1?r:0,d=e.column+l,u=`${t.name}:${o}:${d}
`,a=n.split(/\r\n|[\n\r]/g),c=a[i];if(c.length>120){const h=Math.floor(d/80),f=d%80,p=[];for(let m=0;m<c.length;m+=80)p.push(c.slice(m,m+80));return u+hi([[`${o} |`,p[0]],...p.slice(1,h+1).map(m=>["|",m]),["|","^".padStart(f)],["|",p[h+1]]])}return u+hi([[`${o-1} |`,a[i-1]],[`${o} |`,c],["|","^".padStart(d)],[`${o+1} |`,a[i+1]]])}function hi(t){const e=t.filter(([n,i])=>i!==void 0),r=Math.max(...e.map(([n])=>n.length));return e.map(([n,i])=>n.padStart(r)+(i?" "+i:"")).join(`
`)}function wo(t){const e=t[0];return e==null||"kind"in e||"length"in e?{nodes:e,source:t[1],positions:t[2],path:t[3],originalError:t[4],extensions:t[5]}:e}class Lr extends Error{constructor(e,...r){var n,i,s;const{nodes:o,source:l,positions:d,path:u,originalError:a,extensions:c}=wo(r);super(e),this.name="GraphQLError",this.path=u!=null?u:void 0,this.originalError=a!=null?a:void 0,this.nodes=fi(Array.isArray(o)?o:o?[o]:void 0);const h=fi((n=this.nodes)===null||n===void 0?void 0:n.map(p=>p.loc).filter(p=>p!=null));this.source=l!=null?l:h==null||(i=h[0])===null||i===void 0?void 0:i.source,this.positions=d!=null?d:h==null?void 0:h.map(p=>p.start),this.locations=d&&l?d.map(p=>Ur(l,p)):h==null?void 0:h.map(p=>Ur(p.source,p.start));const f=yo(a==null?void 0:a.extensions)?a==null?void 0:a.extensions:void 0;this.extensions=(s=c!=null?c:f)!==null&&s!==void 0?s:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),a!=null&&a.stack?Object.defineProperty(this,"stack",{value:a.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,Lr):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const r of this.nodes)r.loc&&(e+=`

`+So(r.loc));else if(this.source&&this.locations)for(const r of this.locations)e+=`

`+di(this.source,r);return e}toJSON(){const e={message:this.message};return this.locations!=null&&(e.locations=this.locations),this.path!=null&&(e.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function fi(t){return t===void 0||t.length===0?void 0:t}function oe(t,e,r){return new Lr(`Syntax Error: ${r}`,{source:t,positions:[e]})}class ko{constructor(e,r,n){this.start=e.start,this.end=r.end,this.startToken=e,this.endToken=r,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class pi{constructor(e,r,n,i,s,o){this.kind=e,this.start=r,this.end=n,this.line=i,this.column=s,this.value=o,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const vi={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},xo=new Set(Object.keys(vi));function mi(t){const e=t==null?void 0:t.kind;return typeof e=="string"&&xo.has(e)}var Ke;(function(t){t.QUERY="query",t.MUTATION="mutation",t.SUBSCRIPTION="subscription"})(Ke||(Ke={}));var Mr;(function(t){t.QUERY="QUERY",t.MUTATION="MUTATION",t.SUBSCRIPTION="SUBSCRIPTION",t.FIELD="FIELD",t.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",t.FRAGMENT_SPREAD="FRAGMENT_SPREAD",t.INLINE_FRAGMENT="INLINE_FRAGMENT",t.VARIABLE_DEFINITION="VARIABLE_DEFINITION",t.SCHEMA="SCHEMA",t.SCALAR="SCALAR",t.OBJECT="OBJECT",t.FIELD_DEFINITION="FIELD_DEFINITION",t.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",t.INTERFACE="INTERFACE",t.UNION="UNION",t.ENUM="ENUM",t.ENUM_VALUE="ENUM_VALUE",t.INPUT_OBJECT="INPUT_OBJECT",t.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(Mr||(Mr={}));var _;(function(t){t.NAME="Name",t.DOCUMENT="Document",t.OPERATION_DEFINITION="OperationDefinition",t.VARIABLE_DEFINITION="VariableDefinition",t.SELECTION_SET="SelectionSet",t.FIELD="Field",t.ARGUMENT="Argument",t.FRAGMENT_SPREAD="FragmentSpread",t.INLINE_FRAGMENT="InlineFragment",t.FRAGMENT_DEFINITION="FragmentDefinition",t.VARIABLE="Variable",t.INT="IntValue",t.FLOAT="FloatValue",t.STRING="StringValue",t.BOOLEAN="BooleanValue",t.NULL="NullValue",t.ENUM="EnumValue",t.LIST="ListValue",t.OBJECT="ObjectValue",t.OBJECT_FIELD="ObjectField",t.DIRECTIVE="Directive",t.NAMED_TYPE="NamedType",t.LIST_TYPE="ListType",t.NON_NULL_TYPE="NonNullType",t.SCHEMA_DEFINITION="SchemaDefinition",t.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",t.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",t.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",t.FIELD_DEFINITION="FieldDefinition",t.INPUT_VALUE_DEFINITION="InputValueDefinition",t.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",t.UNION_TYPE_DEFINITION="UnionTypeDefinition",t.ENUM_TYPE_DEFINITION="EnumTypeDefinition",t.ENUM_VALUE_DEFINITION="EnumValueDefinition",t.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",t.DIRECTIVE_DEFINITION="DirectiveDefinition",t.SCHEMA_EXTENSION="SchemaExtension",t.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",t.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",t.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",t.UNION_TYPE_EXTENSION="UnionTypeExtension",t.ENUM_TYPE_EXTENSION="EnumTypeExtension",t.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(_||(_={}));function Fr(t){return t===9||t===32}function lt(t){return t>=48&&t<=57}function gi(t){return t>=97&&t<=122||t>=65&&t<=90}function yi(t){return gi(t)||t===95}function Ao(t){return gi(t)||lt(t)||t===95}function Io(t){var e;let r=Number.MAX_SAFE_INTEGER,n=null,i=-1;for(let o=0;o<t.length;++o){var s;const l=t[o],d=Oo(l);d!==l.length&&(n=(s=n)!==null&&s!==void 0?s:o,i=o,o!==0&&d<r&&(r=d))}return t.map((o,l)=>l===0?o:o.slice(r)).slice((e=n)!==null&&e!==void 0?e:0,i+1)}function Oo(t){let e=0;for(;e<t.length&&Fr(t.charCodeAt(e));)++e;return e}function bo(t,e){const r=t.replace(/"""/g,'\\"""'),n=r.split(/\r\n|[\n\r]/g),i=n.length===1,s=n.length>1&&n.slice(1).every(f=>f.length===0||Fr(f.charCodeAt(0))),o=r.endsWith('\\"""'),l=t.endsWith('"')&&!o,d=t.endsWith("\\"),u=l||d,a=!i||t.length>70||u||s||o;let c="";const h=i&&Fr(t.charCodeAt(0));return(a&&!h||s)&&(c+=`
`),c+=r,(a||u)&&(c+=`
`),'"""'+c+'"""'}var y;(function(t){t.SOF="<SOF>",t.EOF="<EOF>",t.BANG="!",t.DOLLAR="$",t.AMP="&",t.PAREN_L="(",t.PAREN_R=")",t.SPREAD="...",t.COLON=":",t.EQUALS="=",t.AT="@",t.BRACKET_L="[",t.BRACKET_R="]",t.BRACE_L="{",t.PIPE="|",t.BRACE_R="}",t.NAME="Name",t.INT="Int",t.FLOAT="Float",t.STRING="String",t.BLOCK_STRING="BlockString",t.COMMENT="Comment"})(y||(y={}));class No{constructor(e){const r=new pi(y.SOF,0,0,0,0);this.source=e,this.lastToken=r,this.token=r,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==y.EOF)do if(e.next)e=e.next;else{const r=Ro(this,e.end);e.next=r,r.prev=e,e=r}while(e.kind===y.COMMENT);return e}}function _o(t){return t===y.BANG||t===y.DOLLAR||t===y.AMP||t===y.PAREN_L||t===y.PAREN_R||t===y.SPREAD||t===y.COLON||t===y.EQUALS||t===y.AT||t===y.BRACKET_L||t===y.BRACKET_R||t===y.BRACE_L||t===y.PIPE||t===y.BRACE_R}function Ye(t){return t>=0&&t<=55295||t>=57344&&t<=1114111}function Gt(t,e){return Ei(t.charCodeAt(e))&&Ti(t.charCodeAt(e+1))}function Ei(t){return t>=55296&&t<=56319}function Ti(t){return t>=56320&&t<=57343}function De(t,e){const r=t.source.body.codePointAt(e);if(r===void 0)return y.EOF;if(r>=32&&r<=126){const n=String.fromCodePoint(r);return n==='"'?`'"'`:`"${n}"`}return"U+"+r.toString(16).toUpperCase().padStart(4,"0")}function ee(t,e,r,n,i){const s=t.line,o=1+r-t.lineStart;return new pi(e,r,n,s,o,i)}function Ro(t,e){const r=t.source.body,n=r.length;let i=e;for(;i<n;){const s=r.charCodeAt(i);switch(s){case 65279:case 9:case 32:case 44:++i;continue;case 10:++i,++t.line,t.lineStart=i;continue;case 13:r.charCodeAt(i+1)===10?i+=2:++i,++t.line,t.lineStart=i;continue;case 35:return Do(t,i);case 33:return ee(t,y.BANG,i,i+1);case 36:return ee(t,y.DOLLAR,i,i+1);case 38:return ee(t,y.AMP,i,i+1);case 40:return ee(t,y.PAREN_L,i,i+1);case 41:return ee(t,y.PAREN_R,i,i+1);case 46:if(r.charCodeAt(i+1)===46&&r.charCodeAt(i+2)===46)return ee(t,y.SPREAD,i,i+3);break;case 58:return ee(t,y.COLON,i,i+1);case 61:return ee(t,y.EQUALS,i,i+1);case 64:return ee(t,y.AT,i,i+1);case 91:return ee(t,y.BRACKET_L,i,i+1);case 93:return ee(t,y.BRACKET_R,i,i+1);case 123:return ee(t,y.BRACE_L,i,i+1);case 124:return ee(t,y.PIPE,i,i+1);case 125:return ee(t,y.BRACE_R,i,i+1);case 34:return r.charCodeAt(i+1)===34&&r.charCodeAt(i+2)===34?Fo(t,i):Co(t,i)}if(lt(s)||s===45)return Po(t,i,s);if(yi(s))return jo(t,i);throw oe(t.source,i,s===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:Ye(s)||Gt(r,i)?`Unexpected character: ${De(t,i)}.`:`Invalid character: ${De(t,i)}.`)}return ee(t,y.EOF,n,n)}function Do(t,e){const r=t.source.body,n=r.length;let i=e+1;for(;i<n;){const s=r.charCodeAt(i);if(s===10||s===13)break;if(Ye(s))++i;else if(Gt(r,i))i+=2;else break}return ee(t,y.COMMENT,e,i,r.slice(e+1,i))}function Po(t,e,r){const n=t.source.body;let i=e,s=r,o=!1;if(s===45&&(s=n.charCodeAt(++i)),s===48){if(s=n.charCodeAt(++i),lt(s))throw oe(t.source,i,`Invalid number, unexpected digit after 0: ${De(t,i)}.`)}else i=jr(t,i,s),s=n.charCodeAt(i);if(s===46&&(o=!0,s=n.charCodeAt(++i),i=jr(t,i,s),s=n.charCodeAt(i)),(s===69||s===101)&&(o=!0,s=n.charCodeAt(++i),(s===43||s===45)&&(s=n.charCodeAt(++i)),i=jr(t,i,s),s=n.charCodeAt(i)),s===46||yi(s))throw oe(t.source,i,`Invalid number, expected digit but got: ${De(t,i)}.`);return ee(t,o?y.FLOAT:y.INT,e,i,n.slice(e,i))}function jr(t,e,r){if(!lt(r))throw oe(t.source,e,`Invalid number, expected digit but got: ${De(t,e)}.`);const n=t.source.body;let i=e+1;for(;lt(n.charCodeAt(i));)++i;return i}function Co(t,e){const r=t.source.body,n=r.length;let i=e+1,s=i,o="";for(;i<n;){const l=r.charCodeAt(i);if(l===34)return o+=r.slice(s,i),ee(t,y.STRING,e,i+1,o);if(l===92){o+=r.slice(s,i);const d=r.charCodeAt(i+1)===117?r.charCodeAt(i+2)===123?Uo(t,i):Lo(t,i):Mo(t,i);o+=d.value,i+=d.size,s=i;continue}if(l===10||l===13)break;if(Ye(l))++i;else if(Gt(r,i))i+=2;else throw oe(t.source,i,`Invalid character within String: ${De(t,i)}.`)}throw oe(t.source,i,"Unterminated string.")}function Uo(t,e){const r=t.source.body;let n=0,i=3;for(;i<12;){const s=r.charCodeAt(e+i++);if(s===125){if(i<5||!Ye(n))break;return{value:String.fromCodePoint(n),size:i}}if(n=n<<4|dt(s),n<0)break}throw oe(t.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+i)}".`)}function Lo(t,e){const r=t.source.body,n=Si(r,e+2);if(Ye(n))return{value:String.fromCodePoint(n),size:6};if(Ei(n)&&r.charCodeAt(e+6)===92&&r.charCodeAt(e+7)===117){const i=Si(r,e+8);if(Ti(i))return{value:String.fromCodePoint(n,i),size:12}}throw oe(t.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+6)}".`)}function Si(t,e){return dt(t.charCodeAt(e))<<12|dt(t.charCodeAt(e+1))<<8|dt(t.charCodeAt(e+2))<<4|dt(t.charCodeAt(e+3))}function dt(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:-1}function Mo(t,e){const r=t.source.body;switch(r.charCodeAt(e+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw oe(t.source,e,`Invalid character escape sequence: "${r.slice(e,e+2)}".`)}function Fo(t,e){const r=t.source.body,n=r.length;let i=t.lineStart,s=e+3,o=s,l="";const d=[];for(;s<n;){const u=r.charCodeAt(s);if(u===34&&r.charCodeAt(s+1)===34&&r.charCodeAt(s+2)===34){l+=r.slice(o,s),d.push(l);const a=ee(t,y.BLOCK_STRING,e,s+3,Io(d).join(`
`));return t.line+=d.length-1,t.lineStart=i,a}if(u===92&&r.charCodeAt(s+1)===34&&r.charCodeAt(s+2)===34&&r.charCodeAt(s+3)===34){l+=r.slice(o,s),o=s+1,s+=4;continue}if(u===10||u===13){l+=r.slice(o,s),d.push(l),u===13&&r.charCodeAt(s+1)===10?s+=2:++s,l="",o=s,i=s;continue}if(Ye(u))++s;else if(Gt(r,s))s+=2;else throw oe(t.source,s,`Invalid character within String: ${De(t,s)}.`)}throw oe(t.source,s,"Unterminated string.")}function jo(t,e){const r=t.source.body,n=r.length;let i=e+1;for(;i<n;){const s=r.charCodeAt(i);if(Ao(s))++i;else break}return ee(t,y.NAME,e,i,r.slice(e,i))}const $o=10,wi=2;function $r(t){return qt(t,[])}function qt(t,e){switch(typeof t){case"string":return JSON.stringify(t);case"function":return t.name?`[function ${t.name}]`:"[function]";case"object":return Vo(t,e);default:return String(t)}}function Vo(t,e){if(t===null)return"null";if(e.includes(t))return"[Circular]";const r=[...e,t];if(Bo(t)){const n=t.toJSON();if(n!==t)return typeof n=="string"?n:qt(n,r)}else if(Array.isArray(t))return qo(t,r);return Go(t,r)}function Bo(t){return typeof t.toJSON=="function"}function Go(t,e){const r=Object.entries(t);return r.length===0?"{}":e.length>wi?"["+Ho(t)+"]":"{ "+r.map(([i,s])=>i+": "+qt(s,e)).join(", ")+" }"}function qo(t,e){if(t.length===0)return"[]";if(e.length>wi)return"[Array]";const r=Math.min($o,t.length),n=t.length-r,i=[];for(let s=0;s<r;++s)i.push(qt(t[s],e));return n===1?i.push("... 1 more item"):n>1&&i.push(`... ${n} more items`),"["+i.join(", ")+"]"}function Ho(t){const e=Object.prototype.toString.call(t).replace(/^\[object /,"").replace(/]$/,"");if(e==="Object"&&typeof t.constructor=="function"){const r=t.constructor.name;if(typeof r=="string"&&r!=="")return r}return e}const Ko=globalThis.process&&globalThis.process.env.NODE_ENV==="production"?function(e,r){return e instanceof r}:function(e,r){if(e instanceof r)return!0;if(typeof e=="object"&&e!==null){var n;const i=r.prototype[Symbol.toStringTag],s=Symbol.toStringTag in e?e[Symbol.toStringTag]:(n=e.constructor)===null||n===void 0?void 0:n.name;if(i===s){const o=$r(e);throw new Error(`Cannot use ${i} "${o}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class ki{constructor(e,r="GraphQL request",n={line:1,column:1}){typeof e=="string"||Bt(!1,`Body must be a string. Received: ${$r(e)}.`),this.body=e,this.name=r,this.locationOffset=n,this.locationOffset.line>0||Bt(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||Bt(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function Yo(t){return Ko(t,ki)}function zo(t,e){return new Jo(t,e).parseDocument()}class Jo{constructor(e,r={}){const n=Yo(e)?e:new ki(e);this._lexer=new No(n),this._options=r,this._tokenCounter=0}parseName(){const e=this.expectToken(y.NAME);return this.node(e,{kind:_.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:_.DOCUMENT,definitions:this.many(y.SOF,this.parseDefinition,y.EOF)})}parseDefinition(){if(this.peek(y.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),r=e?this._lexer.lookahead():this._lexer.token;if(r.kind===y.NAME){switch(r.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw oe(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(r.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(r)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(y.BRACE_L))return this.node(e,{kind:_.OPERATION_DEFINITION,operation:Ke.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const r=this.parseOperationType();let n;return this.peek(y.NAME)&&(n=this.parseName()),this.node(e,{kind:_.OPERATION_DEFINITION,operation:r,name:n,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(y.NAME);switch(e.value){case"query":return Ke.QUERY;case"mutation":return Ke.MUTATION;case"subscription":return Ke.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(y.PAREN_L,this.parseVariableDefinition,y.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:_.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(y.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(y.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(y.DOLLAR),this.node(e,{kind:_.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:_.SELECTION_SET,selections:this.many(y.BRACE_L,this.parseSelection,y.BRACE_R)})}parseSelection(){return this.peek(y.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,r=this.parseName();let n,i;return this.expectOptionalToken(y.COLON)?(n=r,i=this.parseName()):i=r,this.node(e,{kind:_.FIELD,alias:n,name:i,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(y.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const r=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(y.PAREN_L,r,y.PAREN_R)}parseArgument(e=!1){const r=this._lexer.token,n=this.parseName();return this.expectToken(y.COLON),this.node(r,{kind:_.ARGUMENT,name:n,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(y.SPREAD);const r=this.expectOptionalKeyword("on");return!r&&this.peek(y.NAME)?this.node(e,{kind:_.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:_.INLINE_FRAGMENT,typeCondition:r?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(e,{kind:_.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:_.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(e){const r=this._lexer.token;switch(r.kind){case y.BRACKET_L:return this.parseList(e);case y.BRACE_L:return this.parseObject(e);case y.INT:return this.advanceLexer(),this.node(r,{kind:_.INT,value:r.value});case y.FLOAT:return this.advanceLexer(),this.node(r,{kind:_.FLOAT,value:r.value});case y.STRING:case y.BLOCK_STRING:return this.parseStringLiteral();case y.NAME:switch(this.advanceLexer(),r.value){case"true":return this.node(r,{kind:_.BOOLEAN,value:!0});case"false":return this.node(r,{kind:_.BOOLEAN,value:!1});case"null":return this.node(r,{kind:_.NULL});default:return this.node(r,{kind:_.ENUM,value:r.value})}case y.DOLLAR:if(e)if(this.expectToken(y.DOLLAR),this._lexer.token.kind===y.NAME){const n=this._lexer.token.value;throw oe(this._lexer.source,r.start,`Unexpected variable "$${n}" in constant value.`)}else throw this.unexpected(r);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:_.STRING,value:e.value,block:e.kind===y.BLOCK_STRING})}parseList(e){const r=()=>this.parseValueLiteral(e);return this.node(this._lexer.token,{kind:_.LIST,values:this.any(y.BRACKET_L,r,y.BRACKET_R)})}parseObject(e){const r=()=>this.parseObjectField(e);return this.node(this._lexer.token,{kind:_.OBJECT,fields:this.any(y.BRACE_L,r,y.BRACE_R)})}parseObjectField(e){const r=this._lexer.token,n=this.parseName();return this.expectToken(y.COLON),this.node(r,{kind:_.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e)})}parseDirectives(e){const r=[];for(;this.peek(y.AT);)r.push(this.parseDirective(e));return r}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const r=this._lexer.token;return this.expectToken(y.AT),this.node(r,{kind:_.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let r;if(this.expectOptionalToken(y.BRACKET_L)){const n=this.parseTypeReference();this.expectToken(y.BRACKET_R),r=this.node(e,{kind:_.LIST_TYPE,type:n})}else r=this.parseNamedType();return this.expectOptionalToken(y.BANG)?this.node(e,{kind:_.NON_NULL_TYPE,type:r}):r}parseNamedType(){return this.node(this._lexer.token,{kind:_.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(y.STRING)||this.peek(y.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("schema");const n=this.parseConstDirectives(),i=this.many(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);return this.node(e,{kind:_.SCHEMA_DEFINITION,description:r,directives:n,operationTypes:i})}parseOperationTypeDefinition(){const e=this._lexer.token,r=this.parseOperationType();this.expectToken(y.COLON);const n=this.parseNamedType();return this.node(e,{kind:_.OPERATION_TYPE_DEFINITION,operation:r,type:n})}parseScalarTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("scalar");const n=this.parseName(),i=this.parseConstDirectives();return this.node(e,{kind:_.SCALAR_TYPE_DEFINITION,description:r,name:n,directives:i})}parseObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("type");const n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:_.OBJECT_TYPE_DEFINITION,description:r,name:n,interfaces:i,directives:s,fields:o})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(y.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(y.BRACE_L,this.parseFieldDefinition,y.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseName(),i=this.parseArgumentDefs();this.expectToken(y.COLON);const s=this.parseTypeReference(),o=this.parseConstDirectives();return this.node(e,{kind:_.FIELD_DEFINITION,description:r,name:n,arguments:i,type:s,directives:o})}parseArgumentDefs(){return this.optionalMany(y.PAREN_L,this.parseInputValueDef,y.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseName();this.expectToken(y.COLON);const i=this.parseTypeReference();let s;this.expectOptionalToken(y.EQUALS)&&(s=this.parseConstValueLiteral());const o=this.parseConstDirectives();return this.node(e,{kind:_.INPUT_VALUE_DEFINITION,description:r,name:n,type:i,defaultValue:s,directives:o})}parseInterfaceTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("interface");const n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:_.INTERFACE_TYPE_DEFINITION,description:r,name:n,interfaces:i,directives:s,fields:o})}parseUnionTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("union");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseUnionMemberTypes();return this.node(e,{kind:_.UNION_TYPE_DEFINITION,description:r,name:n,directives:i,types:s})}parseUnionMemberTypes(){return this.expectOptionalToken(y.EQUALS)?this.delimitedMany(y.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("enum");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseEnumValuesDefinition();return this.node(e,{kind:_.ENUM_TYPE_DEFINITION,description:r,name:n,directives:i,values:s})}parseEnumValuesDefinition(){return this.optionalMany(y.BRACE_L,this.parseEnumValueDefinition,y.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseEnumValueName(),i=this.parseConstDirectives();return this.node(e,{kind:_.ENUM_VALUE_DEFINITION,description:r,name:n,directives:i})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw oe(this._lexer.source,this._lexer.token.start,`${Ht(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("input");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseInputFieldsDefinition();return this.node(e,{kind:_.INPUT_OBJECT_TYPE_DEFINITION,description:r,name:n,directives:i,fields:s})}parseInputFieldsDefinition(){return this.optionalMany(y.BRACE_L,this.parseInputValueDef,y.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===y.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const r=this.parseConstDirectives(),n=this.optionalMany(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);if(r.length===0&&n.length===0)throw this.unexpected();return this.node(e,{kind:_.SCHEMA_EXTENSION,directives:r,operationTypes:n})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const r=this.parseName(),n=this.parseConstDirectives();if(n.length===0)throw this.unexpected();return this.node(e,{kind:_.SCALAR_TYPE_EXTENSION,name:r,directives:n})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(n.length===0&&i.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:_.OBJECT_TYPE_EXTENSION,name:r,interfaces:n,directives:i,fields:s})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(n.length===0&&i.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:_.INTERFACE_TYPE_EXTENSION,name:r,interfaces:n,directives:i,fields:s})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseUnionMemberTypes();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:_.UNION_TYPE_EXTENSION,name:r,directives:n,types:i})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseEnumValuesDefinition();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:_.ENUM_TYPE_EXTENSION,name:r,directives:n,values:i})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseInputFieldsDefinition();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:_.INPUT_OBJECT_TYPE_EXTENSION,name:r,directives:n,fields:i})}parseDirectiveDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("directive"),this.expectToken(y.AT);const n=this.parseName(),i=this.parseArgumentDefs(),s=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const o=this.parseDirectiveLocations();return this.node(e,{kind:_.DIRECTIVE_DEFINITION,description:r,name:n,arguments:i,repeatable:s,locations:o})}parseDirectiveLocations(){return this.delimitedMany(y.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,r=this.parseName();if(Object.prototype.hasOwnProperty.call(Mr,r.value))return r;throw this.unexpected(e)}node(e,r){return this._options.noLocation!==!0&&(r.loc=new ko(e,this._lexer.lastToken,this._lexer.source)),r}peek(e){return this._lexer.token.kind===e}expectToken(e){const r=this._lexer.token;if(r.kind===e)return this.advanceLexer(),r;throw oe(this._lexer.source,r.start,`Expected ${xi(e)}, found ${Ht(r)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e?(this.advanceLexer(),!0):!1}expectKeyword(e){const r=this._lexer.token;if(r.kind===y.NAME&&r.value===e)this.advanceLexer();else throw oe(this._lexer.source,r.start,`Expected "${e}", found ${Ht(r)}.`)}expectOptionalKeyword(e){const r=this._lexer.token;return r.kind===y.NAME&&r.value===e?(this.advanceLexer(),!0):!1}unexpected(e){const r=e!=null?e:this._lexer.token;return oe(this._lexer.source,r.start,`Unexpected ${Ht(r)}.`)}any(e,r,n){this.expectToken(e);const i=[];for(;!this.expectOptionalToken(n);)i.push(r.call(this));return i}optionalMany(e,r,n){if(this.expectOptionalToken(e)){const i=[];do i.push(r.call(this));while(!this.expectOptionalToken(n));return i}return[]}many(e,r,n){this.expectToken(e);const i=[];do i.push(r.call(this));while(!this.expectOptionalToken(n));return i}delimitedMany(e,r){this.expectOptionalToken(e);const n=[];do n.push(r.call(this));while(this.expectOptionalToken(e));return n}advanceLexer(){const{maxTokens:e}=this._options,r=this._lexer.advance();if(e!==void 0&&r.kind!==y.EOF&&(++this._tokenCounter,this._tokenCounter>e))throw oe(this._lexer.source,r.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function Ht(t){const e=t.value;return xi(t.kind)+(e!=null?` "${e}"`:"")}function xi(t){return _o(t)?`"${t}"`:t}function Wo(t){return`"${t.replace(Qo,Xo)}"`}const Qo=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function Xo(t){return Zo[t.charCodeAt(0)]}const Zo=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],ea=Object.freeze({});function ta(t,e,r=vi){const n=new Map;for(const E of Object.values(_))n.set(E,ra(e,E));let i,s=Array.isArray(t),o=[t],l=-1,d=[],u=t,a,c;const h=[],f=[];do{l++;const E=l===o.length,w=E&&d.length!==0;if(E){if(a=f.length===0?void 0:h[h.length-1],u=c,c=f.pop(),w)if(s){u=u.slice();let O=0;for(const[F,U]of d){const P=F-O;U===null?(u.splice(P,1),O++):u[P]=U}}else{u=Object.defineProperties({},Object.getOwnPropertyDescriptors(u));for(const[O,F]of d)u[O]=F}l=i.index,o=i.keys,d=i.edits,s=i.inArray,i=i.prev}else if(c){if(a=s?l:o[l],u=c[a],u==null)continue;h.push(a)}let x;if(!Array.isArray(u)){var p,m;mi(u)||Bt(!1,`Invalid AST Node: ${$r(u)}.`);const O=E?(p=n.get(u.kind))===null||p===void 0?void 0:p.leave:(m=n.get(u.kind))===null||m===void 0?void 0:m.enter;if(x=O==null?void 0:O.call(e,u,a,c,h,f),x===ea)break;if(x===!1){if(!E){h.pop();continue}}else if(x!==void 0&&(d.push([a,x]),!E))if(mi(x))u=x;else{h.pop();continue}}if(x===void 0&&w&&d.push([a,u]),E)h.pop();else{var k;i={inArray:s,index:l,keys:o,edits:d,prev:i},s=Array.isArray(u),o=s?u:(k=r[u.kind])!==null&&k!==void 0?k:[],l=-1,d=[],c&&f.push(c),c=u}}while(i!==void 0);return d.length!==0?d[d.length-1][1]:t}function ra(t,e){const r=t[e];return typeof r=="object"?r:typeof r=="function"?{enter:r,leave:void 0}:{enter:t.enter,leave:t.leave}}function na(t){return ta(t,sa)}const ia=80,sa={Name:{leave:t=>t.value},Variable:{leave:t=>"$"+t.name},Document:{leave:t=>I(t.definitions,`

`)},OperationDefinition:{leave(t){const e=C("(",I(t.variableDefinitions,", "),")"),r=I([t.operation,I([t.name,e]),I(t.directives," ")]," ");return(r==="query"?"":r+" ")+t.selectionSet}},VariableDefinition:{leave:({variable:t,type:e,defaultValue:r,directives:n})=>t+": "+e+C(" = ",r)+C(" ",I(n," "))},SelectionSet:{leave:({selections:t})=>ge(t)},Field:{leave({alias:t,name:e,arguments:r,directives:n,selectionSet:i}){const s=C("",t,": ")+e;let o=s+C("(",I(r,", "),")");return o.length>ia&&(o=s+C(`(
`,Kt(I(r,`
`)),`
)`)),I([o,I(n," "),i]," ")}},Argument:{leave:({name:t,value:e})=>t+": "+e},FragmentSpread:{leave:({name:t,directives:e})=>"..."+t+C(" ",I(e," "))},InlineFragment:{leave:({typeCondition:t,directives:e,selectionSet:r})=>I(["...",C("on ",t),I(e," "),r]," ")},FragmentDefinition:{leave:({name:t,typeCondition:e,variableDefinitions:r,directives:n,selectionSet:i})=>`fragment ${t}${C("(",I(r,", "),")")} on ${e} ${C("",I(n," ")," ")}`+i},IntValue:{leave:({value:t})=>t},FloatValue:{leave:({value:t})=>t},StringValue:{leave:({value:t,block:e})=>e?bo(t):Wo(t)},BooleanValue:{leave:({value:t})=>t?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:t})=>t},ListValue:{leave:({values:t})=>"["+I(t,", ")+"]"},ObjectValue:{leave:({fields:t})=>"{"+I(t,", ")+"}"},ObjectField:{leave:({name:t,value:e})=>t+": "+e},Directive:{leave:({name:t,arguments:e})=>"@"+t+C("(",I(e,", "),")")},NamedType:{leave:({name:t})=>t},ListType:{leave:({type:t})=>"["+t+"]"},NonNullType:{leave:({type:t})=>t+"!"},SchemaDefinition:{leave:({description:t,directives:e,operationTypes:r})=>C("",t,`
`)+I(["schema",I(e," "),ge(r)]," ")},OperationTypeDefinition:{leave:({operation:t,type:e})=>t+": "+e},ScalarTypeDefinition:{leave:({description:t,name:e,directives:r})=>C("",t,`
`)+I(["scalar",e,I(r," ")]," ")},ObjectTypeDefinition:{leave:({description:t,name:e,interfaces:r,directives:n,fields:i})=>C("",t,`
`)+I(["type",e,C("implements ",I(r," & ")),I(n," "),ge(i)]," ")},FieldDefinition:{leave:({description:t,name:e,arguments:r,type:n,directives:i})=>C("",t,`
`)+e+(Ai(r)?C(`(
`,Kt(I(r,`
`)),`
)`):C("(",I(r,", "),")"))+": "+n+C(" ",I(i," "))},InputValueDefinition:{leave:({description:t,name:e,type:r,defaultValue:n,directives:i})=>C("",t,`
`)+I([e+": "+r,C("= ",n),I(i," ")]," ")},InterfaceTypeDefinition:{leave:({description:t,name:e,interfaces:r,directives:n,fields:i})=>C("",t,`
`)+I(["interface",e,C("implements ",I(r," & ")),I(n," "),ge(i)]," ")},UnionTypeDefinition:{leave:({description:t,name:e,directives:r,types:n})=>C("",t,`
`)+I(["union",e,I(r," "),C("= ",I(n," | "))]," ")},EnumTypeDefinition:{leave:({description:t,name:e,directives:r,values:n})=>C("",t,`
`)+I(["enum",e,I(r," "),ge(n)]," ")},EnumValueDefinition:{leave:({description:t,name:e,directives:r})=>C("",t,`
`)+I([e,I(r," ")]," ")},InputObjectTypeDefinition:{leave:({description:t,name:e,directives:r,fields:n})=>C("",t,`
`)+I(["input",e,I(r," "),ge(n)]," ")},DirectiveDefinition:{leave:({description:t,name:e,arguments:r,repeatable:n,locations:i})=>C("",t,`
`)+"directive @"+e+(Ai(r)?C(`(
`,Kt(I(r,`
`)),`
)`):C("(",I(r,", "),")"))+(n?" repeatable":"")+" on "+I(i," | ")},SchemaExtension:{leave:({directives:t,operationTypes:e})=>I(["extend schema",I(t," "),ge(e)]," ")},ScalarTypeExtension:{leave:({name:t,directives:e})=>I(["extend scalar",t,I(e," ")]," ")},ObjectTypeExtension:{leave:({name:t,interfaces:e,directives:r,fields:n})=>I(["extend type",t,C("implements ",I(e," & ")),I(r," "),ge(n)]," ")},InterfaceTypeExtension:{leave:({name:t,interfaces:e,directives:r,fields:n})=>I(["extend interface",t,C("implements ",I(e," & ")),I(r," "),ge(n)]," ")},UnionTypeExtension:{leave:({name:t,directives:e,types:r})=>I(["extend union",t,I(e," "),C("= ",I(r," | "))]," ")},EnumTypeExtension:{leave:({name:t,directives:e,values:r})=>I(["extend enum",t,I(e," "),ge(r)]," ")},InputObjectTypeExtension:{leave:({name:t,directives:e,fields:r})=>I(["extend input",t,I(e," "),ge(r)]," ")}};function I(t,e=""){var r;return(r=t==null?void 0:t.filter(n=>n).join(e))!==null&&r!==void 0?r:""}function ge(t){return C(`{
`,Kt(I(t,`
`)),`
}`)}function C(t,e,r=""){return e!=null&&e!==""?t+e+r:""}function Kt(t){return C("  ",t.replace(/\n/g,`
  `))}function Ai(t){var e;return(e=t==null?void 0:t.some(r=>r.includes(`
`)))!==null&&e!==void 0?e:!1}function oa(t,e,r){return t.document?t:{document:t,variables:e,config:r}}function Ii(t){var e;let r;const n=t.definitions.filter(i=>i.kind==="OperationDefinition");return n.length===1&&(r=(e=n[0].name)==null?void 0:e.value),r}function aa(t){if(typeof t=="string"){let r;try{const n=zo(t);r=Ii(n)}catch{}return{query:t,operationName:r}}const e=Ii(t);return{query:na(t),operationName:e}}let ca=class{constructor(e){this.headers={},this.isAccessTokenValidOrNull=()=>{if(!this.accessToken)return!0;try{const i=Qt(this.accessToken);return i.exp!=null&&i.exp*1e3>Date.now()}catch(i){return console.error("Error decoding token:",i),!1}},this.awaitForValidAccessTokenOrNull=async()=>{if(this.isAccessTokenValidOrNull())return!0;const i=()=>this.isAccessTokenValidOrNull()?Promise.resolve(!0):new Promise(s=>{setTimeout(()=>i().then(s),100)});return i()};const{url:r,adminSecret:n}=e;this._url=r,this.accessToken=null,this.adminSecret=n}async request(e,...r){const[n,i]=r,s=oa(e,n,i),{headers:o,...l}=i||{},{query:d,operationName:u}=aa(s.document);typeof process!="undefined"&&!process.env.TEST_MODE&&await this.awaitForValidAccessTokenOrNull();try{const a=await li(this.httpUrl,{method:"POST",body:JSON.stringify({operationName:u,query:d,variables:n}),headers:{"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...this.headers,...o},...l});if(!a.ok)return{data:null,error:{error:a.statusText,message:a.statusText,status:a.status}};const{data:c,errors:h}=await a.json();return h?{data:null,error:h}:typeof c!="object"||Array.isArray(c)||c===null?{data:null,error:{error:"invalid-response",message:"incorrect response data from GraphQL server",status:0}}:{data:c,error:null}}catch(a){const c=a;return{data:null,error:{message:c.message,status:c.name==="AbortError"?0:500,error:c.name==="AbortError"?"abort-error":"unknown"}}}}get httpUrl(){return this._url}get wsUrl(){return this._url.replace(/^(http)(s?):\/\//,"ws$2://")}get url(){return this._url}getUrl(){return this._url}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}getHeaders(){return this.headers}setHeaders(e){e&&(this.headers={...this.headers,...e})}unsetHeaders(){const e=this.headers["x-hasura-role"];this.headers=e?{"x-hasura-role":e}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}};const ua=/^((?<protocol>http[s]?):\/\/)?(?<host>(localhost|local))(:(?<port>(\d+|__\w+__)))?$/;function Yt(t,e){const{subdomain:r,region:n}=t;if(!r)throw new Error("A `subdomain` must be set.");const i=r.match(ua);if(i!=null&&i.groups){const{protocol:s,host:o,port:l}=i.groups;return ha(e)||(o==="localhost"?(console.warn('The `subdomain` is set to "localhost". Support for this will be removed in a future release. Please use "local" instead.'),`${s||"http"}://localhost:${l||1337}/v1/${e}`):l?`${s||"https"}://local.${e}.nhost.run:${l}/v1`:`${s||"https"}://local.${e}.nhost.run/v1`)}if(!n)throw new Error('`region` must be set when using a `subdomain` other than "local".');return`https://${r}.${e}.${n}.nhost.run/v1`}function la(){return typeof window!="undefined"}function da(){return typeof process!="undefined"&&process.env}function ha(t){return la()||!da()?null:process.env[`NHOST_${t.toUpperCase()}_URL`]}function fa(t,e){const r=e.startsWith("/")?e:`/${e}`;return t+r}function pa(t){const e="subdomain"in t?Yt(t,"auth"):t.authUrl,{subdomain:r,region:n}=t;if(!e)throw new Error("Please provide `subdomain` or `authUrl`.");return new co({url:e,broadcastKey:`${r}${n!=null?n:"local"}`,...t})}function va(t){const e="subdomain"in t?Yt(t,"functions"):t.functionsUrl;if(!e)throw new Error("Please provide `subdomain` or `functionsUrl`.");return new ma({url:e,...t})}class ma{constructor(e){this.headers={};const{url:r,adminSecret:n}=e;this.url=r,this.accessToken=null,this.adminSecret=n}async call(e,r,n){var i,s;const o={"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...n==null?void 0:n.headers,...this.headers},l=fa(this.url,e);try{const d=await li(l,{body:r?JSON.stringify(r):null,headers:o,method:"POST"});if(!d.ok){let a;return(i=d.headers.get("content-type"))!=null&&i.includes("application/json")?a=await d.json():a=await d.text(),{res:null,error:{message:a,error:d.statusText,status:d.status}}}let u;return(s=d.headers.get("content-type"))!=null&&s.includes("application/json")?u=await d.json():u=await d.text(),{res:{data:u,status:d.status,statusText:d.statusText},error:null}}catch(d){const u=d;return{res:null,error:{message:u.message,status:u.name==="AbortError"?0:500,error:u.name==="AbortError"?"abort-error":"unknown"}}}}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}getHeaders(){return this.headers}setHeaders(e){e&&(this.headers={...this.headers,...e})}unsetHeaders(){const e=this.headers["x-hasura-role"];this.headers=e?{"x-hasura-role":e}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}function ga(t){const e="subdomain"in t?Yt(t,"graphql"):t.graphqlUrl;if(!e)throw new Error("Please provide `subdomain` or `graphqlUrl`.");return new ca({url:e,...t})}function ya(t){const e="subdomain"in t?Yt(t,"storage"):t.storageUrl;if(!e)throw new Error("Please provide `subdomain` or `storageUrl`.");return new ho({url:e,...t})}class Ea{constructor({refreshIntervalTime:e,clientStorage:r,clientStorageType:n,autoRefreshToken:i,autoSignIn:s,adminSecret:o,devTools:l,start:d=!0,...u}){this.auth=pa({refreshIntervalTime:e,clientStorage:r,clientStorageType:n,autoRefreshToken:i,autoSignIn:s,start:d,...u}),this.storage=ya({adminSecret:o,...u}),this.functions=va({adminSecret:o,...u}),this.graphql=ga({adminSecret:o,...u}),this.auth.onAuthStateChanged((a,c)=>{if(a==="SIGNED_OUT"){this.storage.setAccessToken(void 0),this.functions.setAccessToken(void 0),this.graphql.setAccessToken(void 0);return}const h=c==null?void 0:c.accessToken;this.storage.setAccessToken(h),this.functions.setAccessToken(h),this.graphql.setAccessToken(h)}),this.auth.onTokenChanged(a=>{const c=a==null?void 0:a.accessToken;this.storage.setAccessToken(c),this.functions.setAccessToken(c),this.graphql.setAccessToken(c)}),this._adminSecret=o,this.devTools=l}get adminSecret(){return this._adminSecret}set adminSecret(e){this._adminSecret=e,this.storage.setAdminSecret(e)}setRole(e){this.graphql.setHeaders({"x-hasura-role":e}),this.storage.setHeaders({"x-hasura-role":e}),this.functions.setHeaders({"x-hasura-role":e})}unsetRole(){this.graphql.setHeaders((({"x-hasura-role":e,...r})=>r)(this.graphql.getHeaders())),this.storage.setHeaders((({"x-hasura-role":e,...r})=>r)(this.storage.getHeaders())),this.functions.setHeaders((({"x-hasura-role":e,...r})=>r)(this.functions.getHeaders()))}}const Vr=Symbol("default-nhost-client");let Ta;function de(){let t;const e=Ta;if(!A.getCurrentInstance())t=()=>e;else{const n=A.inject(Vr,null);t=()=>n}function r(){const n=t();if(!n)throw new Error("No Nhost client found. Use provideNhostClient() if you are outside of a component setup.");return n}return{resolveNhostClient:r,get nhost(){return r()}}}class Sa extends Ea{constructor(e){var r;super({...e,start:!0}),this.autoSignIn=(r=e.autoSignIn)!=null?r:!0}install(e){const r=this.autoSignIn;if(e.provide(Vr,this),r){const n=e.config.globalProperties.$router;if(!n)return;if(n.options.history.base){A.warn("[Nhost]: Vue-router is configured with a history Hash Mode. Refresh tokens will not be removed from the hash.");return}n.afterEach(()=>{$t("refreshToken"),$t("type")})}}}var zt=function(){return zt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},zt.apply(this,arguments)},wa=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},ka=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(l){o={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s};function Pe(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=ka(e,2),i=n[0],s=i===void 0?{}:i,o=n[1],l=typeof t=="function"?t():t,d=s.context,u=s.guards,a=s.actions,c=s.activities,h=s.services,f=s.delays,p=s.state,m=wa(s,["context","guards","actions","activities","services","delays","state"]),k={context:d,guards:u,actions:a,activities:c,services:h,delays:f},E=l.withConfig(k,function(){return zt(zt({},l.context),d)}),w=_e(E,m).start(p?ve.create(p):void 0),x;return A.onMounted(function(){o&&(x=w.subscribe(Ze(o)))}),A.onBeforeUnmount(function(){w.stop(),x==null||x.unsubscribe()}),w}function xa(t){return"state"in t}function Aa(t){return"getSnapshot"in t?t.getSnapshot():xa(t)?t.state:void 0}var Ia=function(t,e){return t===e};function g(t,e,r,n){r===void 0&&(r=Ia),n===void 0&&(n=Aa);var i=A.shallowRef(e(n(t))),s=function(l){r(i.value,l)||(i.value=l)},o;return A.onMounted(function(){var l=e(n(t));s(l),o=t.subscribe(function(d){var u=e(d);s(u)})}),A.onBeforeUnmount(function(){o==null||o.unsubscribe()}),i}const J=()=>{const{nhost:t}=de();return A.computed(()=>{const e=t.auth.client.interpreter;if(!e)throw Error("No interpreter");return e})},Jt=()=>{const t=J();return g(t.value,e=>e.context.accessToken.value)},Br=()=>{const t=J();return g(t.value,e=>e.matches({authentication:"signedIn"}))};function Oa(t){return typeof t=="function"?t():ft.unref(t)}typeof WorkerGlobalScope!="undefined"&&globalThis instanceof WorkerGlobalScope;function ba(t,e={}){if(!ft.isRef(t))return ft.toRefs(t);const r=Array.isArray(t.value)?Array.from({length:t.value.length}):{};for(const n in t.value)r[n]=ft.customRef(()=>({get(){return t.value[n]},set(i){var s;if((s=Oa(e.replaceRef))!=null?s:!0)if(Array.isArray(t.value)){const l=[...t.value];l[n]=i,t.value=l}else{const l={...t.value,[n]:i};Object.setPrototypeOf(l,Object.getPrototypeOf(t.value)),t.value=l}else t.value[n]=i}}));return r}const Na=()=>{const t=J();return ba(g(t.value,e=>({isAuthenticated:e.matches({authentication:"signedIn"}),isLoading:e.hasTag("loading"),error:e.context.errors.authentication||null,isError:e.matches({authentication:{signedOut:"failed"}}),connectionAttempts:e.context.importTokenAttempts}),(e,r)=>e.isAuthenticated===r.isAuthenticated&&e.isLoading===r.isLoading&&e.connectionAttempts===r.connectionAttempts))},ye=t=>{const e=A.unref(t);return Array.isArray(e)?e.map(r=>ye(r)):e&&typeof e=="object"?Object.entries(e).reduce((r,[n,i])=>({...r,[n]:ye(i)}),{}):e},_a=t=>{const{nhost:e}=de(),r=Pe(jn(e.auth.client)),n=g(r,d=>d.matches("requesting")),i=g(r,d=>d.context.error),s=g(r,d=>d.matches("idle.error")),o=g(r,d=>d.matches("idle.success"));return{changeEmail:d=>qn(r,A.unref(d),ye(t)),isLoading:n,error:i,isError:s,needsEmailVerification:o}},Ra=()=>{const{nhost:t}=de(),e=Pe($n(t.auth.client)),r=g(e,l=>l.matches("requesting")),n=g(e,l=>l.context.error),i=g(e,l=>l.matches("idle.error")),s=g(e,l=>l.matches("idle.success"));return{changePassword:l=>Hn(e,A.unref(l)),isLoading:r,error:n,isError:i,isSuccess:s}},Da=()=>{const{nhost:t}=de(),e=Pe(no(t.auth.client)),r=g(e,c=>c.matches({idle:"error"})||c.matches({generated:{idle:"error"}})),n=g(e,c=>c.matches("generating")),i=g(e,c=>c.matches("generated")),s=g(e,c=>c.matches({generated:"activating"})),o=g(e,c=>c.matches({generated:"activated"})),l=g(e,c=>c.context.error),d=g(e,c=>c.context.imageUrl||"");return{generateQrCode:()=>so(e),isGenerating:n,qrCodeDataUrl:d,isGenerated:i,activateMfa:c=>oo(e,A.unref(c)),isActivating:s,isActivated:o,isError:r,error:l}},Oi=()=>{const t=Jt();return A.computed(()=>t.value?Qt(t.value):null)},bi=t=>{const{nhost:e}=de(),r=p=>{t.send({type:"ADD",file:p.file,bucketId:p.bucketId||h.value})},n=p=>po({url:e.storage.url,accessToken:e.auth.getAccessToken(),adminSecret:e.adminSecret,...p},t),i=()=>{t.send("CANCEL")},s=()=>{t.send("DESTROY")},o=g(t,p=>p.matches("uploading")),l=g(t,p=>p.matches("uploaded")),d=g(t,p=>p.matches("error")),u=g(t,p=>p.context.error||null),a=g(t,p=>p.context.progress),c=g(t,p=>p.context.id),h=g(t,p=>p.context.bucketId),f=g(t,p=>{var m;return(m=p.context.file)==null?void 0:m.name});return{add:r,upload:n,cancel:i,destroy:s,isUploaded:l,isUploading:o,isError:d,error:u,progress:a,id:c,bucketId:h,name:f}},Pa=()=>{const t=Pe(ci);return bi(t)},Gr=()=>{const t=Oi();return A.computed(()=>{var e;return((e=t.value)==null?void 0:e["https://hasura.io/jwt/claims"])||null})},Ca=t=>{const e=Gr();return A.computed(()=>{var n;const r=A.unref(t);return((n=e.value)==null?void 0:n[r.startsWith("x-hasura-")?r:`x-hasura-${r}`])||null})},Ua=()=>{const{nhost:t}=de(),e=A.ref([]),r=Pe(fo,{},h=>{h.event.type==="UPLOAD_ERROR"?e.value=h.context.files.filter(f=>{var p;return(p=f.getSnapshot())==null?void 0:p.context.error}):(h.matches("uploaded")||h.event.type==="CLEAR")&&e.value.length>0&&(e.value=[])}),n=h=>{r.send({type:"ADD",...h})},i=h=>vo({url:t.storage.url,accessToken:t.auth.getAccessToken(),adminSecret:t.adminSecret,...h},r),s=()=>{r.send("CANCEL")},o=()=>{r.send("CLEAR")},l=g(r,h=>h.matches("uploading")),d=g(r,h=>h.matches("uploaded")),u=g(r,h=>h.matches("error")),a=g(r,h=>h.context.progress),c=g(r,h=>h.context.files);return{upload:i,add:n,clear:o,cancel:s,progress:a,isUploaded:d,isUploading:l,files:c,isError:u,errors:e}},La=t=>{const{nhost:e}=de(),r=Jt();return A.reactive(new Proxy({},{get(n,i){const s=ye(t),o=s!=null&&s.connect?{connect:r.value}:{};return Ft(`${e.auth.client.backendUrl}/signin/provider/${i}`,le(e.auth.client.clientUrl,{...s,...o}))}}))},Ma=t=>{const{nhost:e}=de(),r=Pe(Vn(e.auth.client)),n=g(r,d=>d.matches("requesting")),i=g(r,d=>d.matches({idle:"success"})),s=g(r,d=>d.matches({idle:"error"})),o=g(r,d=>d.context.error);return{resetPassword:d=>Kn(r,A.unref(d),ye(t)),isLoading:n,isError:s,isSent:i,error:o}},Fa=t=>{const{nhost:e}=de(),r=Pe(Bn(e.auth.client)),n=g(r,o=>o.matches("requesting")),i=A.reactive({isError:!1,error:null,isSent:!1});return{sendEmail:o=>Yn(r,A.unref(o),ye(t)),isLoading:n,...A.toRefs(i)}},ht=t=>{const e=J();return g(e.value,r=>r.context.errors[t]||null,(r,n)=>(r==null?void 0:r.error)===(n==null?void 0:n.error))},ja=()=>{const t=J(),e=()=>zn(t.value),r=ht("authentication"),n=g(t.value,o=>o.matches({authentication:{authenticating:"anonymous"}})),i=Br(),s=g(t.value,o=>o.matches({authentication:{signedOut:"failed"}}));return{signInAnonymous:e,isLoading:n,isSuccess:i,isError:s,error:r}},$a=()=>{const t=J(),e=(f,p)=>Jn(t.value,A.unref(f),A.unref(p)),r=f=>Xn(t.value,A.unref(f)),n=g(t.value,f=>f.context.user,(f,p)=>(f==null?void 0:f.id)===(p==null?void 0:p.id)),i=g(t.value,f=>f.context.accessToken.value),s=g(t.value,f=>f.context.refreshToken.value),o=ht("authentication"),l=Br(),d=g(t.value,f=>f.matches({authentication:{authenticating:"password"}}),(f,p)=>f===p),u=g(t.value,f=>f.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(f,p)=>f===p),a=g(t.value,f=>f.context.mfa),c=g(t.value,f=>f.matches({authentication:{signedOut:"needsMfa"}}),(f,p)=>f===p),h=g(t.value,f=>f.matches({authentication:{signedOut:"failed"}}),(f,p)=>f===p);return{accessToken:i,refreshToken:s,error:o,isError:h,isLoading:d,isSuccess:l,needsEmailVerification:u,needsMfaOtp:c,mfa:a,sendMfaOtp:r,signInEmailPassword:e,user:n}},Va=t=>{const e=J(),r=l=>Ar(e.value,A.unref(l),ye(t)),n=ht("registration"),i=g(e.value,l=>l.matches("registration.passwordlessEmail")),s=g(e.value,l=>l.matches("registration.incomplete.needsEmailVerification")),o=g(e.value,l=>l.matches("registration.incomplete.failed"));return{signInEmailPasswordless:r,isLoading:i,isSuccess:s,isError:o,error:n}},Ba=()=>{const t=J(),e=u=>Zn(t.value,A.unref(u)),r=g(t.value,u=>u.context.user,(u,a)=>(u==null?void 0:u.id)===(a==null?void 0:a.id)),n=g(t.value,u=>u.context.accessToken.value),i=g(t.value,u=>u.context.refreshToken.value),s=g(t.value,u=>u.context.errors.authentication||null,(u,a)=>(u==null?void 0:u.error)===(a==null?void 0:a.error)),o=g(t.value,u=>u.matches({authentication:"signedIn"})),l=g(t.value,u=>u.matches({authentication:{authenticating:"password"}}),(u,a)=>u===a),d=g(t.value,u=>u.matches({authentication:{signedOut:"failed"}}),(u,a)=>u===a);return{accessToken:n,refreshToken:i,error:s,isError:d,isLoading:l,isSuccess:o,signInPAT:e,user:r}};function Ga(t){const e=J(),r=A.ref(""),n=(a,c=t)=>(r.value=A.unref(a),Ir(e.value,A.unref(a),ye(c))),i=async(...a)=>{if(a.length===2){const[h,f]=a;return Or(e.value,A.unref(h),A.unref(f))}const[c]=a;return Or(e.value,A.unref(r),A.unref(c))},s=g(e.value,a=>a.context.errors.registration||null,(a,c)=>(a==null?void 0:a.error)===(c==null?void 0:c.error)),o=g(e.value,a=>a.matches("registration.passwordlessSms")||a.matches("registration.passwordlessSmsOtp")),l=g(e.value,a=>a.matches("authentication.signedIn")),d=g(e.value,a=>a.matches("registration.incomplete.needsOtp")),u=g(e.value,a=>a.matches("registration.incomplete.failed"));return{signInSmsPasswordless:n,sendOtp:i,isLoading:o,isSuccess:l,needsOtp:d,isError:u,error:s}}const qa=()=>{const t=J(),e=i=>ei(t.value,typeof A.unref(i)=="boolean"?A.unref(i):!1),r=g(t.value,i=>i.matches({authentication:{signedOut:"success"}})),n=ht("signout");return{signOut:e,isSuccess:r,error:n}},qr=()=>{const t=J();return g(t.value,e=>e.context.user,(e,r)=>JSON.stringify(e)===JSON.stringify(r))},Ha=t=>{const e=J(),r=g(e.value,c=>c.matches("registration.incomplete.failed")),n=ht("registration"),i=g(e.value,c=>c.matches("registration.emailPassword")),s=g(e.value,c=>c.matches({authentication:"signedIn",registration:"complete"})),o=g(e.value,c=>c.matches("registration.incomplete.needsEmailVerification")),l=Jt(),d=g(e.value,c=>c.context.refreshToken.value),u=qr();return{signUpEmailPassword:(c,h,f)=>br(e.value,A.unref(c),A.unref(h),{...ye(t),...ye(f)}),isLoading:i,isSuccess:s,isError:r,error:n,needsEmailVerification:o,accessToken:l,refreshToken:d,user:u}},Ka=()=>{const t=J();return g(t.value,e=>{var r;return(r=e.context.user)==null?void 0:r.avatarUrl},(e,r)=>e===r)},Ya=()=>{const t=J();return g(t.value,e=>{var r;return(r=e.context.user)==null?void 0:r.defaultRole},(e,r)=>e===r)},za=()=>{const t=J();return g(t.value,e=>{var r;return(r=e.context.user)==null?void 0:r.displayName},(e,r)=>e===r)},Ja=()=>{const t=J();return g(t.value,e=>{var r;return(r=e.context.user)==null?void 0:r.email},(e,r)=>e===r)},Wa=()=>{const t=J();return g(t.value,e=>{var r;return(r=e.context.user)==null?void 0:r.id},(e,r)=>e===r)},Qa=()=>{const t=J();return g(t.value,e=>{var r;return(r=e.context.user)==null?void 0:r.isAnonymous},(e,r)=>e===r)},Xa=()=>{const t=J();return g(t.value,e=>{var r;return(r=e.context.user)==null?void 0:r.locale},(e,r)=>e===r)},Za=()=>{const t=J();return g(t.value,e=>{var r;return e.matches("authentication.signedIn")?((r=e.context.user)==null?void 0:r.roles)||[]:[]})},ec=()=>{const t=qr(),e=Gr(),{nhost:r}=de(),n=A.computed(()=>{var o,l;return t.value?((o=e.value)==null?void 0:o["x-hasura-auth-elevated"])===((l=t.value)==null?void 0:l.id):!1}),i=A.computed(()=>!!n.value);return{elevateEmailSecurityKey:o=>Qn(r.auth.client,A.unref(o)),elevated:i}},tc=t=>{const e=J(),r=g(e.value,c=>!!c.context.errors.registration),n=g(e.value,c=>c.context.errors.registration||null,(c,h)=>(c==null?void 0:c.error)===(h==null?void 0:h.error)),i=g(e.value,c=>c.matches("registration.securityKey")),s=g(e.value,c=>c.matches("registration.incomplete.needsEmailVerification")),o=g(e.value,c=>c.matches({authentication:"signedIn",registration:"complete"})),l=(c,h=t)=>ti(e.value,A.unref(c),A.unref(h)),d=g(e.value,c=>c.context.user,(c,h)=>(c==null?void 0:c.id)===(h==null?void 0:h.id)),u=g(e.value,c=>c.context.accessToken.value),a=g(e.value,c=>c.context.refreshToken.value);return{accessToken:u,refreshToken:a,error:n,isError:r,isLoading:i,isSuccess:o,needsEmailVerification:s,signUpEmailSecurityKey:l,user:d}},rc=()=>{const t=J(),e=a=>Wn(t.value,A.unref(a)),r=g(t.value,a=>a.context.user,(a,c)=>(a==null?void 0:a.id)===(c==null?void 0:c.id)),n=g(t.value,a=>a.context.accessToken.value),i=g(t.value,a=>a.context.refreshToken.value),s=g(t.value,a=>a.context.errors.authentication||null,(a,c)=>(a==null?void 0:a.error)===(c==null?void 0:c.error)),o=g(t.value,a=>a.matches({authentication:"signedIn"})),l=g(t.value,a=>a.matches({authentication:{authenticating:"securityKeyEmail"}}),(a,c)=>a===c),d=g(t.value,a=>a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(a,c)=>a===c),u=g(t.value,a=>a.matches({authentication:{signedOut:"failed"}}),(a,c)=>a===c);return{accessToken:n,refreshToken:i,error:s,isError:u,isLoading:l,isSuccess:o,needsEmailVerification:d,signInEmailSecurityKey:e,user:r}},nc=()=>{const{nhost:t}=de(),e=A.ref(null),r=A.computed(()=>!e),n=A.computed(()=>!!e),i=A.ref(!1);return{add:async o=>{i.value=!0;const l=await Gn(t.auth.client,o),{error:d}=l;return e&&(e.value=d),i.value=!1,l},isLoading:i,isSuccess:r,isError:n,error:e}};function ic(t){const e=J(),r=(u,a=t)=>ri(e.value,A.unref(u),ye(a)),n=async(u,a)=>ni(e.value,A.unref(u),A.unref(a)),i=g(e.value,u=>u.context.errors.registration||null,(u,a)=>(u==null?void 0:u.error)===(a==null?void 0:a.error)),s=g(e.value,u=>u.matches("registration.signInEmailOTP")||u.matches("registration.verifyEmailOTP")),o=g(e.value,u=>u.matches("authentication.signedIn")),l=g(e.value,u=>u.matches("registration.incomplete.needsOtp")),d=g(e.value,u=>u.matches("registration.incomplete.failed"));return{signInEmailOTP:r,verifyEmailOTP:n,needsOtp:l,isLoading:s,isSuccess:o,isError:d,error:i}}const sc=()=>{const t=J(),e=(u,a,c)=>ii(t.value,{provider:A.unref(u),idToken:A.unref(a),nonce:A.unref(c)}),r=g(t.value,u=>u.context.user,(u,a)=>(u==null?void 0:u.id)===(a==null?void 0:a.id)),n=g(t.value,u=>u.context.accessToken.value),i=g(t.value,u=>u.context.refreshToken.value),s=g(t.value,u=>u.context.errors.authentication||null,(u,a)=>(u==null?void 0:u.error)===(a==null?void 0:a.error)),o=g(t.value,u=>u.matches({authentication:"signedIn"})),l=g(t.value,u=>u.matches({authentication:{authenticating:"idToken"}}),(u,a)=>u===a),d=g(t.value,u=>u.matches({authentication:{signedOut:"failed"}}),(u,a)=>u===a);return{accessToken:n,refreshToken:i,error:s,isError:d,isLoading:l,isSuccess:o,signInIdToken:e,user:r}},oc=()=>{const{nhost:t}=de(),e=A.ref(null),r=A.computed(()=>!e),n=A.computed(()=>!!e),i=A.ref(!1);return{linkIdToken:async({provider:o,idToken:l,nonce:d})=>{i.value=!0;const u=await si(t.auth.client,{provider:o,idToken:l,...d&&{nonce:d}}),{error:a}=u;return e&&(e.value=a),i.value=!1,u},isLoading:i,isSuccess:r,isError:n,error:e}},ac=()=>{const t=J(),e=()=>oi(t.value),r=g(t.value,a=>a.context.user,(a,c)=>(a==null?void 0:a.id)===(c==null?void 0:c.id)),n=g(t.value,a=>a.context.accessToken.value),i=g(t.value,a=>a.context.refreshToken.value),s=g(t.value,a=>a.context.errors.authentication||null,(a,c)=>(a==null?void 0:a.error)===(c==null?void 0:c.error)),o=g(t.value,a=>a.matches({authentication:"signedIn"})),l=g(t.value,a=>a.matches({authentication:{authenticating:"securityKeyEmail"}}),(a,c)=>a===c),d=g(t.value,a=>a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(a,c)=>a===c),u=g(t.value,a=>a.matches({authentication:{signedOut:"failed"}}),(a,c)=>a===c);return{accessToken:n,refreshToken:i,error:s,isError:u,isLoading:l,isSuccess:o,needsEmailVerification:d,signInSecurityKey:e,user:r}};b.DefaultNhostClient=Vr,b.NhostClient=Sa,b.useAccessToken=Jt,b.useAddSecurityKey=nc,b.useAuthInterpreter=J,b.useAuthenticated=Br,b.useAuthenticationStatus=Na,b.useChangeEmail=_a,b.useChangePassword=Ra,b.useConfigMfa=Da,b.useDecodedAccessToken=Oi,b.useElevateSecurityKeyEmail=ec,b.useFileUpload=Pa,b.useFileUploadItem=bi,b.useHasuraClaim=Ca,b.useHasuraClaims=Gr,b.useLinkIdToken=oc,b.useMultipleFilesUpload=Ua,b.useNhostClient=de,b.useProviderLink=La,b.useResetPassword=Ma,b.useSendVerificationEmail=Fa,b.useSignInAnonymous=ja,b.useSignInEmailOTP=ic,b.useSignInEmailPassword=$a,b.useSignInEmailPasswordless=Va,b.useSignInEmailSecurityKey=rc,b.useSignInIdToken=sc,b.useSignInPAT=Ba,b.useSignInSecurityKey=ac,b.useSignInSmsPasswordless=Ga,b.useSignOut=qa,b.useSignUpEmailPassword=Ha,b.useSignUpEmailSecurityKey=tc,b.useUserAvatarUrl=Ka,b.useUserData=qr,b.useUserDefaultRole=Ya,b.useUserDisplayName=za,b.useUserEmail=Ja,b.useUserId=Wa,b.useUserIsAnonymous=Qa,b.useUserLocale=Xa,b.useUserRoles=Za,Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=vue.umd.js.map
